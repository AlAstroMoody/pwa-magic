import{_ as o}from"./IButton.vuevuetypescriptsetuptruelang-DCbEXGaB.js";import{d as C,x as S,g as m,y as P,c as D,o as h,h as u,a as k,w as c,b as l,i as n}from"./index-Bs-7ZeCf.js";import{s as d}from"./error-oUr4zJjZ.js";const p="user_media_devices";async function O(){try{let t;const e=sessionStorage.getItem(p);return e?t=JSON.parse(e):(t=await navigator.mediaDevices.enumerateDevices(),sessionStorage.setItem(p,JSON.stringify(t))),{devices:t}}catch(t){return{error:t}}}function E(){return navigator.mediaDevices.getSupportedConstraints()}async function M(t){if(!t)return null;try{const e=await navigator.mediaDevices.getDisplayMedia();return t.srcObject=e,e}catch(e){throw console.error("Get display media error:",e),e}}async function N(t){if(t)try{document.pictureInPictureElement?await document.exitPictureInPicture():(t.paused&&await t.play(),await t.requestPictureInPicture())}catch(e){alert(`Ошибка PiP: ${d(e)}`)}}async function x(t,e={video:!0,audio:!0}){if(!t)return null;try{const s=await navigator.mediaDevices.getUserMedia(e);return t.srcObject=s,s}catch(s){throw console.error("Get user media error:",s),s}}const G={class:"api-content__wrapper"},J=C({__name:"MediaCapture",setup(t){const e=S("video"),s=m(null),v=m(null),i=m(null),f=()=>{i.value&&(i.value.getTracks().forEach(r=>r.stop()),i.value=null,e.value&&(e.value.srcObject=null))},y=async()=>{const r=await O();r.devices?(s.value=r.devices,alert(JSON.stringify(r.devices))):r.error&&alert(`Ошибка: ${d(r.error)}`)},_=()=>{v.value=E(),alert(JSON.stringify(v.value))},g=async()=>{try{f();const r=await x(e.value);i.value=r}catch(r){alert(`Ошибка захвата камеры: ${d(r)}`)}},w=async()=>{try{f();const r=await M(e.value);i.value=r}catch(r){alert(`Ошибка захвата экрана: ${d(r)}`)}};return P(()=>f()),(r,a)=>(h(),D("div",G,[u(n(o),{onClick:y},{default:c(()=>a[1]||(a[1]=[l("Получить список доступных устройств")])),_:1,__:[1]}),u(n(o),{onClick:_},{default:c(()=>a[2]||(a[2]=[l("Получить список требований к потоку")])),_:1,__:[2]}),u(n(o),{onClick:g},{default:c(()=>a[3]||(a[3]=[l("Захват камеры")])),_:1,__:[3]}),u(n(o),{onClick:w},{default:c(()=>a[4]||(a[4]=[l("Захват экрана")])),_:1,__:[4]}),u(n(o),{onClick:a[0]||(a[0]=I=>n(N)(e.value))},{default:c(()=>a[5]||(a[5]=[l("Toggle Picture-in-Picture")])),_:1,__:[5]}),k("video",{ref_key:"video",ref:e,width:"320",height:"240",class:"media-capture__video",autoplay:""},null,512)]))}});export{J as default};
