import{_ as i}from"./IButton.vuevuetypescriptsetuptruelang-3ghqKoPh.js";import{d as D,s as O,f as d,x as $,o as p,c as g,g as o,w as u,b as l,u as s,a as E,i as M,F as N}from"./index-COVE8rQ0.js";import{s as f}from"./error-oUr4zJjZ.js";import{_ as x}from"./RTCConnector.vuevuetypestyleindex0lang-DUKWvNNA.js";const w="user_media_devices";async function G(){try{let t;const e=sessionStorage.getItem(w);return e?t=JSON.parse(e):(t=await navigator.mediaDevices.enumerateDevices(),sessionStorage.setItem(w,JSON.stringify(t))),{devices:t}}catch(t){return{error:t}}}function I(){return navigator.mediaDevices.getSupportedConstraints()}async function T(t){if(!t)return null;try{const e=await navigator.mediaDevices.getDisplayMedia();return t.srcObject=e,e}catch(e){throw console.error("Get display media error:",e),e}}async function b(t){if(t)try{document.pictureInPictureElement?await document.exitPictureInPicture():(t.paused&&await t.play(),await t.requestPictureInPicture())}catch(e){alert(`Ошибка PiP: ${f(e)}`)}}async function h(t,e={video:!0,audio:!0}){if(!t)return null;try{const n=await navigator.mediaDevices.getUserMedia(e);return t.srcObject=n,n}catch(n){throw console.error("Get user media error:",n),n}}const B={key:0,class:"api-content__wrapper"},R=D({__name:"MediaCapture",setup(t){const e=O("video"),n=d(null),y=d(null),c=d(null),m=()=>{c.value&&(c.value.getTracks().forEach(r=>r.stop()),c.value=null,e.value&&(e.value.srcObject=null))},C=async()=>{const r=await G();r.devices?(n.value=r.devices,alert(JSON.stringify(r.devices))):r.error&&alert(`Ошибка: ${f(r.error)}`)},_=()=>{y.value=I(),alert(JSON.stringify(y.value))},k=async()=>{try{m();const r=await h(e.value);c.value=r}catch(r){alert(`Ошибка захвата камеры: ${f(r)}`)}},S=async()=>{try{m();const r=await T(e.value);c.value=r}catch(r){alert(`Ошибка захвата экрана: ${f(r)}`)}},v=d(!0);return $(()=>{m()}),(r,a)=>(p(),g(N,null,[v.value?(p(),g("div",B,[o(s(i),{onClick:C},{default:u(()=>a[2]||(a[2]=[l("Получить список доступных устройств")])),_:1}),o(s(i),{onClick:_},{default:u(()=>a[3]||(a[3]=[l("Получить список требований к потоку")])),_:1}),o(s(i),{onClick:k},{default:u(()=>a[4]||(a[4]=[l("Захват камеры")])),_:1}),o(s(i),{onClick:S},{default:u(()=>a[5]||(a[5]=[l("Захват экрана")])),_:1}),o(s(i),{onClick:a[0]||(a[0]=P=>s(b)(s(e)))},{default:u(()=>a[6]||(a[6]=[l("Toggle Picture-in-Picture")])),_:1}),E("video",{ref_key:"video",ref:e,width:"320",height:"240",class:"media-capture__video",autoplay:""},null,512)])):(p(),M(x,{key:1})),o(s(i),{onClick:a[1]||(a[1]=P=>v.value=!v.value)},{default:u(()=>a[7]||(a[7]=[l("RTC test")])),_:1})],64))}});export{R as default};
