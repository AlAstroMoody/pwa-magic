import{_}from"./IButton.vuevuetypescriptsetuptruelang-DCbEXGaB.js";import{d as h,g as i,c as o,o as n,h as f,n as g,w as m,b as p,i as y,t as w}from"./index-Bs-7ZeCf.js";import{s as b}from"./error-oUr4zJjZ.js";const k={key:0},C={key:1},x={key:0},$=h({__name:"WebBluetooth",setup(D){const v=i("bluetooth"in navigator),t=i(0);async function l(){await(async({bleService:e,bleCharacteristic:s})=>{try{if(!navigator.bluetooth)return;const a=await navigator.bluetooth.requestDevice({filters:[{services:[e]}]});a.addEventListener("gattserverdisconnected",()=>{t.value=0});const r=await(await(await a.gatt.connect()).getPrimaryService(e)).getCharacteristic(s);return await r.startNotifications(),r.addEventListener("characteristicvaluechanged",u=>{const c=u.target.value.getUint8(0);console.log(`${s} changed`,c),t.value=c}),r.readValue(),r}catch(a){alert(`Ошибка: ${b(a)}`)}})({bleService:"battery_service",bleCharacteristic:"battery_level"})}return(d,e)=>v.value?(n(),o("div",C,[f(y(_),{onClick:l},{default:m(()=>e[0]||(e[0]=[p("scan")])),_:1,__:[0]}),t.value?(n(),o("div",x,"Уровень заряда устройства: "+w(t.value),1)):g("",!0)])):(n(),o("div",k,"Не поддерживается устройством"))}});export{$ as default};
