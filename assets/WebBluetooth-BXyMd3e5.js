import{_}from"./IButton.vuevuetypescriptsetuptruelang-BmDO9Tjc.js";import{d as f,f as i,o,c as n,g,w as h,b as m,u as p,t as y,n as w}from"./index-zO2yB-9a.js";import{s as b}from"./error-oUr4zJjZ.js";const k={key:0},C={key:1},x={key:0},$=f({__name:"WebBluetooth",setup(D){const v=i("bluetooth"in navigator),t=i(0);async function l(){await(async({bleService:e,bleCharacteristic:s})=>{try{if(!navigator.bluetooth)return;const a=await navigator.bluetooth.requestDevice({filters:[{services:[e]}]});a.addEventListener("gattserverdisconnected",()=>{t.value=0});const r=await(await(await a.gatt.connect()).getPrimaryService(e)).getCharacteristic(s);return await r.startNotifications(),r.addEventListener("characteristicvaluechanged",d=>{const c=d.target.value.getUint8(0);console.log(`${s} changed`,c),t.value=c}),r.readValue(),r}catch(a){alert(`Ошибка: ${b(a)}`)}})({bleService:"battery_service",bleCharacteristic:"battery_level"})}return(u,e)=>v.value?(o(),n("div",C,[g(p(_),{onClick:l},{default:h(()=>e[0]||(e[0]=[m("scan")])),_:1}),t.value?(o(),n("div",x,"Уровень заряда устройства: "+y(t.value),1)):w("",!0)])):(o(),n("div",k,"Не поддерживается устройством"))}});export{$ as default};
