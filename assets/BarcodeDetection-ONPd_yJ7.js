import{_ as w}from"./IButton.vuevuetypescriptsetuptruelang-C_RGIsWW.js";import{d as _,f as c,o as n,c as i,g as h,w as y,b as g,u as k,n as u,t as E}from"./index-DDos786x.js";import{s as f}from"./error-oUr4zJjZ.js";const B={key:0},D={key:1},b={key:1},A=_({__name:"BarcodeDetection",setup(x){const m=c("BarcodeDetector"in window),l=c(null),a=c(!1),e=c(null),v=new Audio("/success-beep.mp3");async function p(){try{if(!window.BarcodeDetector)throw new Error("Barcode Detection API не поддерживается");const s=new window.BarcodeDetector({formats:["qr_code","ean_13","code_128","upc_a"]}),t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(a.value=!0,e.value)e.value.srcObject=t,await e.value.play(),await new Promise(r=>{e.value.onloadedmetadata=()=>r()});else throw new Error("Видеоэлемент недоступен");const d=async()=>{try{if(!e.value||e.value.paused){a.value=!1,t.getTracks().forEach(o=>o.stop());return}const r=await s.detect(e.value);r.length>0?(l.value=r[0].rawValue,await v.play().catch(o=>console.error("Ошибка воспроизведения звука:",o)),t.getTracks().forEach(o=>o.stop()),a.value=!1):requestAnimationFrame(d)}catch(r){alert(`Ошибка: ${f(r)}`),t.getTracks().forEach(o=>o.stop()),a.value=!1}};requestAnimationFrame(d)}catch(s){alert(`Ошибка: ${f(s)}`),a.value=!1}}return(s,t)=>m.value?(n(),i("div",D,[h(k(w),{onClick:p,disabled:a.value},{default:y(()=>t[0]||(t[0]=[g("Сканировать QR-код")])),_:1},8,["disabled"]),a.value?(n(),i("video",{key:0,ref_key:"videoElement",ref:e,style:{width:"100%","max-width":"400px","margin-top":"10px"}},null,512)):u("",!0),l.value?(n(),i("div",b,"Обнаруженный QR-код: "+E(l.value),1)):u("",!0)])):(n(),i("div",B,"QR-сканер не поддерживается устройством"))}});export{A as default};
