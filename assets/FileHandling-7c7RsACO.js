import{_ as p}from"./IButton.vuevuetypescriptsetuptruelang-DCbEXGaB.js";import{d as k,g as o,c as u,o as i,a as s,n as c,h as F,j as b,w as h,i as y,b as C,t as d}from"./index-Bs-7ZeCf.js";import{s as f}from"./error-oUr4zJjZ.js";const x={key:0},H={key:1},L={class:"file-handler__actions"},j={key:0,class:"file-handler__status"},B={key:1,class:"file-handler__details"},N=["src"],E=k({__name:"FileHandling",setup(R){const v=o("launchQueue"in window&&"LaunchParams"in window),a=o(null),t=o(null),n=o(!1);async function m(){v.value&&"launchQueue"in window&&window.launchQueue.setConsumer(async l=>{if(l.files.length!==0){n.value=!0;try{const r=await l.files[0].getFile();await _(r)}catch(e){alert(`Ошибка обработки файла: ${f(e)}`)}finally{n.value=!1}}})}async function _(l){try{if(!l.type.startsWith("image/"))throw new Error("Файл не является изображением");a.value=l,t.value=URL.createObjectURL(l)}catch(e){alert(`Ошибка: ${f(e)}`),a.value=null,t.value=null}}async function w(l){const e=l.target;if(!(!e.files||e.files.length===0)){n.value=!0;try{const r=e.files[0];await _(r)}catch(r){alert(`Ошибка: ${f(r)}`)}finally{n.value=!1}}}function g(){t.value&&URL.revokeObjectURL(t.value),a.value=null,t.value=null}return m(),(l,e)=>v.value?(i(),u("div",H,[s("div",L,[F(y(p),{disabled:n.value},{default:h(()=>[e[0]||(e[0]=s("label",{for:"fileInput"},"Выбрать файл",-1)),s("input",{id:"fileInput",type:"file",accept:"image/png,image/jpeg",style:{display:"none"},onChange:w},null,32)]),_:1,__:[0]},8,["disabled"]),a.value?(i(),b(y(p),{key:0,onClick:g,disabled:n.value},{default:h(()=>e[1]||(e[1]=[C(" Очистить ")])),_:1,__:[1]},8,["disabled"])):c("",!0)]),n.value?(i(),u("div",j,"Обработка файла...")):c("",!0),a.value?(i(),u("div",B,[s("div",null,"Выбранный файл: "+d(a.value.name),1),s("div",null,"Размер: "+d((a.value.size/1024).toFixed(2))+" КБ",1),s("div",null,"Тип: "+d(a.value.type),1)])):c("",!0),t.value?(i(),u("img",{key:2,src:t.value,class:"file-handler__preview",alt:"Превью изображения"},null,8,N)):c("",!0)])):(i(),u("div",x,"File Handling API не поддерживается устройством"))}});export{E as default};
