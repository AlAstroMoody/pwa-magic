import{_}from"./IButton.vuevuetypescriptsetuptruelang-DBVeNaCR.js";import{d as w,f as c,o as n,c as i,g as h,w as y,b as g,u as k,n as u,t as B}from"./index-BuHdXMni.js";import{s as f}from"./error-oUr4zJjZ.js";const D={key:0},b={key:1},x={key:1},A=w({__name:"BarcodeDetection",setup(E){const m=c("BarcodeDetector"in window),d=c(null),e=c(!1),t=c(null),v=new Audio("/success-beep.mp3");async function p(){try{if(!window.BarcodeDetector)throw new Error("Barcode Detection API не поддерживается");const r=new window.BarcodeDetector({formats:["qr_code","ean_13","code_128","upc_a"]}),a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});e.value=!0,t.value&&(t.value.srcObject=a,await t.value.play());const l=async()=>{try{if(!t.value)return;const s=await r.detect(t.value);s.length>0?(d.value=s[0].rawValue,await v.play().catch(o=>console.error("Ошибка воспроизведения звука:",o)),a.getTracks().forEach(o=>o.stop()),e.value=!1):requestAnimationFrame(l)}catch(s){alert(`Ошибка: ${f(s)}`),a.getTracks().forEach(o=>o.stop()),e.value=!1}};requestAnimationFrame(l)}catch(r){alert(`Ошибка: ${f(r)}`),e.value=!1}}return(r,a)=>m.value?(n(),i("div",b,[h(k(_),{onClick:p,disabled:e.value},{default:y(()=>a[0]||(a[0]=[g("Сканировать QR-код")])),_:1},8,["disabled"]),e.value?(n(),i("video",{key:0,ref_key:"videoElement",ref:t,style:{width:"100%","max-width":"400px","margin-top":"10px"}},null,512)):u("",!0),d.value?(n(),i("div",x,"Обнаруженный QR-код: "+B(d.value),1)):u("",!0)])):(n(),i("div",D,"QR-сканер не поддерживается устройством"))}});export{A as default};
