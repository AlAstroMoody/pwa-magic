import{_ as d}from"./IButton.vuevuetypescriptsetuptruelang-DCbEXGaB.js";import{d as T,g as s,c as i,o as c,n as p,a as C,h as f,w as v,b as w,t as g,i as m,F as P}from"./index-Bs-7ZeCf.js";import{s as _}from"./error-oUr4zJjZ.js";const I={key:0},x={key:1},A={class:"api-content__wrapper"},$={key:0},N={key:1},E=T({__name:"WebSpeech",setup(V){const r=s("SpeechRecognition"in window||"webkitSpeechRecognition"in window),u=s(window.location.protocol==="https:"||window.location.hostname==="localhost"),l=s(null),n=s(!1),h=s(null),o=s(null),k=window.SpeechRecognition||window.webkitSpeechRecognition;async function S(){if(!r.value)return!1;try{const e=await navigator.permissions.query({name:"microphone"});return h.value=e.state,e.state==="granted"||e.state==="prompt"}catch{return!1}}async function b(){if(!r.value){alert("Speech Recognition не поддерживается.");return}if(!u.value){alert("Для работы Speech API требуется HTTPS или localhost.");return}if(!await S()){alert("Доступ к микрофону не разрешён. Проверьте настройки браузера.");return}try{const e=new k;o.value=e,e.lang="ru-RU",e.continuous=!1,e.interimResults=!1,e.onresult=function(t){if(t.results&&t.results.length>0&&t.results[0].length>0){const a=t.results[0][0];l.value=a.transcript}else l.value="Результаты не получены.";n.value=!1},e.onerror=function(t){let a="Неизвестная ошибка";switch(t.error){case"no-speech":a="Речь не обнаружена.";break;case"aborted":a="Распознавание прервано.";break;case"audio-capture":a="Микрофон недоступен.";break;case"not-allowed":a="Доступ к микрофону запрещён.";break;case"network":a="Ошибка сети.";break;default:a=`Ошибка: ${t.error}`}alert(a),n.value=!1,o.value=null},e.onend=function(){n.value=!1,o.value=null},e.start(),n.value=!0}catch(e){alert(`Ошибка: ${_(e)}`)}}function y(){if(n.value&&o.value)try{o.value.stop(),n.value=!1,o.value=null}catch(e){alert(`Ошибка: ${_(e)}`)}}function R(){if(!("speechSynthesis"in window)){alert("Speech Synthesis не поддерживается.");return}if(!u.value){alert("Для работы Speech API рекомендуется HTTPS или localhost.");return}try{window.speechSynthesis.cancel();const e=new SpeechSynthesisUtterance(l.value||"I've seen things... seen things you little people wouldn't believe. Attack ships on fire off the shoulder of Orion bright as magnesium... I rode on the back decks of a blinker and watched C-beams glitter in the dark near the Tannhäuser Gate. All those moments... they'll be gone");e.lang="ru-RU",window.speechSynthesis.speak(e)}catch(e){alert(`Ошибка: ${_(e)}`)}}return(e,t)=>(c(),i(P,null,[u.value?r.value?p("",!0):(c(),i("div",x,"Speech API не поддерживается")):(c(),i("div",I,"Для работы Speech API требуется HTTPS или localhost")),C("div",A,[f(m(d),{onClick:b,disabled:n.value||!r.value||!u.value},{default:v(()=>[w(g(n.value?"Распознавание...":"Начать распознавание"),1)]),_:1},8,["disabled"]),f(m(d),{onClick:y,disabled:!n.value},{default:v(()=>t[0]||(t[0]=[w(" Остановить распознавание ")])),_:1,__:[0]},8,["disabled"]),f(m(d),{onClick:R,disabled:!r.value},{default:v(()=>t[1]||(t[1]=[w(" Озвучить текст ")])),_:1,__:[1]},8,["disabled"]),l.value?(c(),i("p",$,"Распознанный текст: "+g(l.value),1)):p("",!0),h.value?(c(),i("p",N,"Статус разрешения микрофона: "+g(h.value),1)):p("",!0)])],64))}});export{E as default};
