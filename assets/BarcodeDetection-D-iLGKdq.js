import{_ as w}from"./IButton.vuevuetypescriptsetuptruelang-Pugw1Evt.js";import{d as _,f as c,o as n,c as i,g as h,w as y,b as k,u as g,n as u,t as E,p as x}from"./index-BDd5O2VW.js";import{s as f}from"./error-oUr4zJjZ.js";const B={key:0},D={key:1},b={key:1},A=_({__name:"BarcodeDetection",setup(C){const v=c("BarcodeDetector"in window),l=c(null),e=c(!1),t=c(null),m=new Audio("/success-beep.mp3");async function p(){try{if(!window.BarcodeDetector)throw new Error("Barcode Detection API не поддерживается");const r=new window.BarcodeDetector({formats:["qr_code","ean_13","code_128","upc_a"]}),a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});if(e.value=!0,await x(),!t.value)throw new Error("Видеоэлемент недоступен");t.value.srcObject=a,await t.value.play();const d=async()=>{try{if(!t.value||t.value.paused){a.getTracks().forEach(o=>o.stop()),e.value=!1;return}const s=await r.detect(t.value);s.length>0?(l.value=s[0].rawValue,await m.play().catch(o=>console.error("Ошибка воспроизведения звука:",o)),a.getTracks().forEach(o=>o.stop()),e.value=!1):requestAnimationFrame(d)}catch(s){alert(`Ошибка: ${f(s)}`),a.getTracks().forEach(o=>o.stop()),e.value=!1}};requestAnimationFrame(d)}catch(r){alert(`Ошибка: ${f(r)}`),e.value=!1}}return(r,a)=>v.value?(n(),i("div",D,[h(g(w),{onClick:p,disabled:e.value},{default:y(()=>a[0]||(a[0]=[k("Сканировать QR-код")])),_:1},8,["disabled"]),e.value?(n(),i("video",{key:0,ref_key:"videoElement",ref:t,style:{width:"100%","max-width":"400px","margin-top":"10px"}},null,512)):u("",!0),l.value?(n(),i("div",b,"Обнаруженный QR-код: "+E(l.value),1)):u("",!0)])):(n(),i("div",B,"QR-сканер не поддерживается устройством"))}});export{A as default};
