import{_ as i}from"./IButton.vuevuetypescriptsetuptruelang-CcZZ4fQU.js";import{d as D,s as O,f as d,x as E,o as p,c as g,g as o,w as u,b as l,u as s,a as M,i as N,F as T}from"./index-D3nPvyUY.js";import{s as f}from"./error-oUr4zJjZ.js";import $ from"./RTCConnector-Bd8EPxPU.js";const w="user_media_devices";async function x(){try{let t;const e=sessionStorage.getItem(w);return e?t=JSON.parse(e):(t=await navigator.mediaDevices.enumerateDevices(),sessionStorage.setItem(w,JSON.stringify(t))),{devices:t}}catch(t){return{error:t}}}function G(){return navigator.mediaDevices.getSupportedConstraints()}async function I(t){if(!t)return null;try{const e=await navigator.mediaDevices.getDisplayMedia();return t.srcObject=e,e}catch(e){throw console.error("Get display media error:",e),e}}async function b(t){if(t)try{document.pictureInPictureElement?await document.exitPictureInPicture():(t.paused&&await t.play(),await t.requestPictureInPicture())}catch(e){alert(`Ошибка PiP: ${f(e)}`)}}async function h(t,e={video:!0,audio:!0}){if(!t)return null;try{const n=await navigator.mediaDevices.getUserMedia(e);return t.srcObject=n,n}catch(n){throw console.error("Get user media error:",n),n}}const B={key:0,class:"api-content__wrapper"},j=D({__name:"MediaCapture",setup(t){const e=O("video"),n=d(null),y=d(null),c=d(null),m=()=>{c.value&&(c.value.getTracks().forEach(r=>r.stop()),c.value=null,e.value&&(e.value.srcObject=null))},C=async()=>{const r=await x();r.devices?(n.value=r.devices,alert(JSON.stringify(r.devices))):r.error&&alert(`Ошибка: ${f(r.error)}`)},k=()=>{y.value=G(),alert(JSON.stringify(y.value))},S=async()=>{try{m();const r=await h(e.value);c.value=r}catch(r){alert(`Ошибка захвата камеры: ${f(r)}`)}},P=async()=>{try{m();const r=await I(e.value);c.value=r}catch(r){alert(`Ошибка захвата экрана: ${f(r)}`)}},v=d(!0);return E(()=>{m()}),(r,a)=>(p(),g(T,null,[v.value?(p(),g("div",B,[o(s(i),{onClick:C},{default:u(()=>a[2]||(a[2]=[l("Получить список доступных устройств")])),_:1}),o(s(i),{onClick:k},{default:u(()=>a[3]||(a[3]=[l("Получить список требований к потоку")])),_:1}),o(s(i),{onClick:S},{default:u(()=>a[4]||(a[4]=[l("Захват камеры")])),_:1}),o(s(i),{onClick:P},{default:u(()=>a[5]||(a[5]=[l("Захват экрана")])),_:1}),o(s(i),{onClick:a[0]||(a[0]=_=>s(b)(s(e)))},{default:u(()=>a[6]||(a[6]=[l("Toggle Picture-in-Picture")])),_:1}),M("video",{ref_key:"video",ref:e,width:"320",height:"240",class:"media-capture__video",autoplay:""},null,512)])):(p(),N($,{key:1})),o(s(i),{onClick:a[1]||(a[1]=_=>v.value=!v.value)},{default:u(()=>a[7]||(a[7]=[l("RTC test")])),_:1})],64))}});export{j as default};
