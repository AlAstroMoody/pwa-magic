import{_ as tt}from"./IButton.vuevuetypescriptsetuptruelang-DBVeNaCR.js";import{d as yn,f as ne,y as rt,z as wn,x as bn,e as ur,o as De,c as Oe,a as te,A as Ti,q as Ei,B as Si,r as Pi,g as Ne,u as je,n as nt,t as lr,w as ot,b as at,_ as _i}from"./index-BuHdXMni.js";import{s as Le}from"./error-oUr4zJjZ.js";var xe={},$i=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},Cn={},se={};let Cr;const Ai=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];se.getSymbolSize=function(n){if(!n)throw new Error('"version" cannot be null or undefined');if(n<1||n>40)throw new Error('"version" should be in range from 1 to 40');return n*4+17};se.getSymbolTotalCodewords=function(n){return Ai[n]};se.getBCHDigit=function(e){let n=0;for(;e!==0;)n++,e>>>=1;return n};se.setToSJISFunction=function(n){if(typeof n!="function")throw new Error('"toSJISFunc" is not a valid function.');Cr=n};se.isKanjiModeEnabled=function(){return typeof Cr<"u"};se.toSJIS=function(n){return Cr(n)};var Bt={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function n(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+o)}}e.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},e.from=function(i,s){if(e.isValid(i))return i;try{return n(i)}catch{return s}}})(Bt);function Tn(){this.buffer=[],this.length=0}Tn.prototype={get:function(e){const n=Math.floor(e/8);return(this.buffer[n]>>>7-e%8&1)===1},put:function(e,n){for(let o=0;o<n;o++)this.putBit((e>>>n-o-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const n=Math.floor(this.length/8);this.buffer.length<=n&&this.buffer.push(0),e&&(this.buffer[n]|=128>>>this.length%8),this.length++}};var Mi=Tn;function ut(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}ut.prototype.set=function(e,n,o,i){const s=e*this.size+n;this.data[s]=o,i&&(this.reservedBit[s]=!0)};ut.prototype.get=function(e,n){return this.data[e*this.size+n]};ut.prototype.xor=function(e,n,o){this.data[e*this.size+n]^=o};ut.prototype.isReserved=function(e,n){return this.reservedBit[e*this.size+n]};var Ri=ut,En={};(function(e){const n=se.getSymbolSize;e.getRowColCoords=function(i){if(i===1)return[];const s=Math.floor(i/7)+2,c=n(i),d=c===145?26:Math.ceil((c-13)/(2*s-2))*2,f=[c-7];for(let l=1;l<s-1;l++)f[l]=f[l-1]-d;return f.push(6),f.reverse()},e.getPositions=function(i){const s=[],c=e.getRowColCoords(i),d=c.length;for(let f=0;f<d;f++)for(let l=0;l<d;l++)f===0&&l===0||f===0&&l===d-1||f===d-1&&l===0||s.push([c[f],c[l]]);return s}})(En);var Sn={};const Di=se.getSymbolSize,on=7;Sn.getPositions=function(n){const o=Di(n);return[[0,0],[o-on,0],[0,o-on]]};var Pn={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};e.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},e.from=function(s){return e.isValid(s)?parseInt(s,10):void 0},e.getPenaltyN1=function(s){const c=s.size;let d=0,f=0,l=0,m=null,w=null;for(let T=0;T<c;T++){f=l=0,m=w=null;for(let $=0;$<c;$++){let _=s.get(T,$);_===m?f++:(f>=5&&(d+=n.N1+(f-5)),m=_,f=1),_=s.get($,T),_===w?l++:(l>=5&&(d+=n.N1+(l-5)),w=_,l=1)}f>=5&&(d+=n.N1+(f-5)),l>=5&&(d+=n.N1+(l-5))}return d},e.getPenaltyN2=function(s){const c=s.size;let d=0;for(let f=0;f<c-1;f++)for(let l=0;l<c-1;l++){const m=s.get(f,l)+s.get(f,l+1)+s.get(f+1,l)+s.get(f+1,l+1);(m===4||m===0)&&d++}return d*n.N2},e.getPenaltyN3=function(s){const c=s.size;let d=0,f=0,l=0;for(let m=0;m<c;m++){f=l=0;for(let w=0;w<c;w++)f=f<<1&2047|s.get(m,w),w>=10&&(f===1488||f===93)&&d++,l=l<<1&2047|s.get(w,m),w>=10&&(l===1488||l===93)&&d++}return d*n.N3},e.getPenaltyN4=function(s){let c=0;const d=s.data.length;for(let l=0;l<d;l++)c+=s.data[l];return Math.abs(Math.ceil(c*100/d/5)-10)*n.N4};function o(i,s,c){switch(i){case e.Patterns.PATTERN000:return(s+c)%2===0;case e.Patterns.PATTERN001:return s%2===0;case e.Patterns.PATTERN010:return c%3===0;case e.Patterns.PATTERN011:return(s+c)%3===0;case e.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(c/3))%2===0;case e.Patterns.PATTERN101:return s*c%2+s*c%3===0;case e.Patterns.PATTERN110:return(s*c%2+s*c%3)%2===0;case e.Patterns.PATTERN111:return(s*c%3+(s+c)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}e.applyMask=function(s,c){const d=c.size;for(let f=0;f<d;f++)for(let l=0;l<d;l++)c.isReserved(l,f)||c.xor(l,f,o(s,l,f))},e.getBestMask=function(s,c){const d=Object.keys(e.Patterns).length;let f=0,l=1/0;for(let m=0;m<d;m++){c(m),e.applyMask(m,s);const w=e.getPenaltyN1(s)+e.getPenaltyN2(s)+e.getPenaltyN3(s)+e.getPenaltyN4(s);e.applyMask(m,s),w<l&&(l=w,f=m)}return f}})(Pn);var Nt={};const Se=Bt,$t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],At=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Nt.getBlocksCount=function(n,o){switch(o){case Se.L:return $t[(n-1)*4+0];case Se.M:return $t[(n-1)*4+1];case Se.Q:return $t[(n-1)*4+2];case Se.H:return $t[(n-1)*4+3];default:return}};Nt.getTotalCodewordsCount=function(n,o){switch(o){case Se.L:return At[(n-1)*4+0];case Se.M:return At[(n-1)*4+1];case Se.Q:return At[(n-1)*4+2];case Se.H:return At[(n-1)*4+3];default:return}};var _n={},jt={};const st=new Uint8Array(512),Ot=new Uint8Array(256);(function(){let n=1;for(let o=0;o<255;o++)st[o]=n,Ot[n]=o,n<<=1,n&256&&(n^=285);for(let o=255;o<512;o++)st[o]=st[o-255]})();jt.log=function(n){if(n<1)throw new Error("log("+n+")");return Ot[n]};jt.exp=function(n){return st[n]};jt.mul=function(n,o){return n===0||o===0?0:st[Ot[n]+Ot[o]]};(function(e){const n=jt;e.mul=function(i,s){const c=new Uint8Array(i.length+s.length-1);for(let d=0;d<i.length;d++)for(let f=0;f<s.length;f++)c[d+f]^=n.mul(i[d],s[f]);return c},e.mod=function(i,s){let c=new Uint8Array(i);for(;c.length-s.length>=0;){const d=c[0];for(let l=0;l<s.length;l++)c[l]^=n.mul(s[l],d);let f=0;for(;f<c.length&&c[f]===0;)f++;c=c.slice(f)}return c},e.generateECPolynomial=function(i){let s=new Uint8Array([1]);for(let c=0;c<i;c++)s=e.mul(s,new Uint8Array([1,n.exp(c)]));return s}})(_n);const $n=_n;function Tr(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}Tr.prototype.initialize=function(n){this.degree=n,this.genPoly=$n.generateECPolynomial(this.degree)};Tr.prototype.encode=function(n){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(n.length+this.degree);o.set(n);const i=$n.mod(o,this.genPoly),s=this.degree-i.length;if(s>0){const c=new Uint8Array(this.degree);return c.set(i,s),c}return i};var Oi=Tr,An={},$e={},Er={};Er.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40};var pe={};const Mn="[0-9]+",Ii="[A-Z $%*+\\-./:]+";let ct="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";ct=ct.replace(/u/g,"\\u");const ki="(?:(?![A-Z0-9 $%*+\\-./:]|"+ct+`)(?:.|[\r
]))+`;pe.KANJI=new RegExp(ct,"g");pe.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");pe.BYTE=new RegExp(ki,"g");pe.NUMERIC=new RegExp(Mn,"g");pe.ALPHANUMERIC=new RegExp(Ii,"g");const Bi=new RegExp("^"+ct+"$"),Ni=new RegExp("^"+Mn+"$"),ji=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");pe.testKanji=function(n){return Bi.test(n)};pe.testNumeric=function(n){return Ni.test(n)};pe.testAlphanumeric=function(n){return ji.test(n)};(function(e){const n=Er,o=pe;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(c,d){if(!c.ccBits)throw new Error("Invalid mode: "+c);if(!n.isValid(d))throw new Error("Invalid version: "+d);return d>=1&&d<10?c.ccBits[0]:d<27?c.ccBits[1]:c.ccBits[2]},e.getBestModeForData=function(c){return o.testNumeric(c)?e.NUMERIC:o.testAlphanumeric(c)?e.ALPHANUMERIC:o.testKanji(c)?e.KANJI:e.BYTE},e.toString=function(c){if(c&&c.id)return c.id;throw new Error("Invalid mode")},e.isValid=function(c){return c&&c.bit&&c.ccBits};function i(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+s)}}e.from=function(c,d){if(e.isValid(c))return c;try{return i(c)}catch{return d}}})($e);(function(e){const n=se,o=Nt,i=Bt,s=$e,c=Er,d=7973,f=n.getBCHDigit(d);function l($,_,A){for(let D=1;D<=40;D++)if(_<=e.getCapacity(D,A,$))return D}function m($,_){return s.getCharCountIndicator($,_)+4}function w($,_){let A=0;return $.forEach(function(D){const N=m(D.mode,_);A+=N+D.getBitsLength()}),A}function T($,_){for(let A=1;A<=40;A++)if(w($,A)<=e.getCapacity(A,_,s.MIXED))return A}e.from=function(_,A){return c.isValid(_)?parseInt(_,10):A},e.getCapacity=function(_,A,D){if(!c.isValid(_))throw new Error("Invalid QR Code version");typeof D>"u"&&(D=s.BYTE);const N=n.getSymbolTotalCodewords(_),R=o.getTotalCodewordsCount(_,A),I=(N-R)*8;if(D===s.MIXED)return I;const b=I-m(D,_);switch(D){case s.NUMERIC:return Math.floor(b/10*3);case s.ALPHANUMERIC:return Math.floor(b/11*2);case s.KANJI:return Math.floor(b/13);case s.BYTE:default:return Math.floor(b/8)}},e.getBestVersionForData=function(_,A){let D;const N=i.from(A,i.M);if(Array.isArray(_)){if(_.length>1)return T(_,N);if(_.length===0)return 1;D=_[0]}else D=_;return l(D.mode,D.getLength(),N)},e.getEncodedBits=function(_){if(!c.isValid(_)||_<7)throw new Error("Invalid QR Code version");let A=_<<12;for(;n.getBCHDigit(A)-f>=0;)A^=d<<n.getBCHDigit(A)-f;return _<<12|A}})(An);var Rn={};const vr=se,Dn=1335,Li=21522,an=vr.getBCHDigit(Dn);Rn.getEncodedBits=function(n,o){const i=n.bit<<3|o;let s=i<<10;for(;vr.getBCHDigit(s)-an>=0;)s^=Dn<<vr.getBCHDigit(s)-an;return(i<<10|s)^Li};var On={};const Fi=$e;function He(e){this.mode=Fi.NUMERIC,this.data=e.toString()}He.getBitsLength=function(n){return 10*Math.floor(n/3)+(n%3?n%3*3+1:0)};He.prototype.getLength=function(){return this.data.length};He.prototype.getBitsLength=function(){return He.getBitsLength(this.data.length)};He.prototype.write=function(n){let o,i,s;for(o=0;o+3<=this.data.length;o+=3)i=this.data.substr(o,3),s=parseInt(i,10),n.put(s,10);const c=this.data.length-o;c>0&&(i=this.data.substr(o),s=parseInt(i,10),n.put(s,c*3+1))};var Ui=He;const xi=$e,dr=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function We(e){this.mode=xi.ALPHANUMERIC,this.data=e}We.getBitsLength=function(n){return 11*Math.floor(n/2)+6*(n%2)};We.prototype.getLength=function(){return this.data.length};We.prototype.getBitsLength=function(){return We.getBitsLength(this.data.length)};We.prototype.write=function(n){let o;for(o=0;o+2<=this.data.length;o+=2){let i=dr.indexOf(this.data[o])*45;i+=dr.indexOf(this.data[o+1]),n.put(i,11)}this.data.length%2&&n.put(dr.indexOf(this.data[o]),6)};var Hi=We;const Wi=$e;function Ve(e){this.mode=Wi.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}Ve.getBitsLength=function(n){return n*8};Ve.prototype.getLength=function(){return this.data.length};Ve.prototype.getBitsLength=function(){return Ve.getBitsLength(this.data.length)};Ve.prototype.write=function(e){for(let n=0,o=this.data.length;n<o;n++)e.put(this.data[n],8)};var Vi=Ve;const zi=$e,Ji=se;function ze(e){this.mode=zi.KANJI,this.data=e}ze.getBitsLength=function(n){return n*13};ze.prototype.getLength=function(){return this.data.length};ze.prototype.getBitsLength=function(){return ze.getBitsLength(this.data.length)};ze.prototype.write=function(e){let n;for(n=0;n<this.data.length;n++){let o=Ji.toSJIS(this.data[n]);if(o>=33088&&o<=40956)o-=33088;else if(o>=57408&&o<=60351)o-=49472;else throw new Error("Invalid SJIS character: "+this.data[n]+`
Make sure your charset is UTF-8`);o=(o>>>8&255)*192+(o&255),e.put(o,13)}};var qi=ze,In={exports:{}};(function(e){var n={single_source_shortest_paths:function(o,i,s){var c={},d={};d[i]=0;var f=n.PriorityQueue.make();f.push(i,0);for(var l,m,w,T,$,_,A,D,N;!f.empty();){l=f.pop(),m=l.value,T=l.cost,$=o[m]||{};for(w in $)$.hasOwnProperty(w)&&(_=$[w],A=T+_,D=d[w],N=typeof d[w]>"u",(N||D>A)&&(d[w]=A,f.push(w,A),c[w]=m))}if(typeof s<"u"&&typeof d[s]>"u"){var R=["Could not find a path from ",i," to ",s,"."].join("");throw new Error(R)}return c},extract_shortest_path_from_predecessor_list:function(o,i){for(var s=[],c=i;c;)s.push(c),o[c],c=o[c];return s.reverse(),s},find_path:function(o,i,s){var c=n.single_source_shortest_paths(o,i,s);return n.extract_shortest_path_from_predecessor_list(c,s)},PriorityQueue:{make:function(o){var i=n.PriorityQueue,s={},c;o=o||{};for(c in i)i.hasOwnProperty(c)&&(s[c]=i[c]);return s.queue=[],s.sorter=o.sorter||i.default_sorter,s},default_sorter:function(o,i){return o.cost-i.cost},push:function(o,i){var s={value:o,cost:i};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=n})(In);var Yi=In.exports;(function(e){const n=$e,o=Ui,i=Hi,s=Vi,c=qi,d=pe,f=se,l=Yi;function m(R){return unescape(encodeURIComponent(R)).length}function w(R,I,b){const v=[];let E;for(;(E=R.exec(b))!==null;)v.push({data:E[0],index:E.index,mode:I,length:E[0].length});return v}function T(R){const I=w(d.NUMERIC,n.NUMERIC,R),b=w(d.ALPHANUMERIC,n.ALPHANUMERIC,R);let v,E;return f.isKanjiModeEnabled()?(v=w(d.BYTE,n.BYTE,R),E=w(d.KANJI,n.KANJI,R)):(v=w(d.BYTE_KANJI,n.BYTE,R),E=[]),I.concat(b,v,E).sort(function(F,Q){return F.index-Q.index}).map(function(F){return{data:F.data,mode:F.mode,length:F.length}})}function $(R,I){switch(I){case n.NUMERIC:return o.getBitsLength(R);case n.ALPHANUMERIC:return i.getBitsLength(R);case n.KANJI:return c.getBitsLength(R);case n.BYTE:return s.getBitsLength(R)}}function _(R){return R.reduce(function(I,b){const v=I.length-1>=0?I[I.length-1]:null;return v&&v.mode===b.mode?(I[I.length-1].data+=b.data,I):(I.push(b),I)},[])}function A(R){const I=[];for(let b=0;b<R.length;b++){const v=R[b];switch(v.mode){case n.NUMERIC:I.push([v,{data:v.data,mode:n.ALPHANUMERIC,length:v.length},{data:v.data,mode:n.BYTE,length:v.length}]);break;case n.ALPHANUMERIC:I.push([v,{data:v.data,mode:n.BYTE,length:v.length}]);break;case n.KANJI:I.push([v,{data:v.data,mode:n.BYTE,length:m(v.data)}]);break;case n.BYTE:I.push([{data:v.data,mode:n.BYTE,length:m(v.data)}])}}return I}function D(R,I){const b={},v={start:{}};let E=["start"];for(let L=0;L<R.length;L++){const F=R[L],Q=[];for(let re=0;re<F.length;re++){const ee=F[re],ue=""+L+re;Q.push(ue),b[ue]={node:ee,lastCount:0},v[ue]={};for(let be=0;be<E.length;be++){const ae=E[be];b[ae]&&b[ae].node.mode===ee.mode?(v[ae][ue]=$(b[ae].lastCount+ee.length,ee.mode)-$(b[ae].lastCount,ee.mode),b[ae].lastCount+=ee.length):(b[ae]&&(b[ae].lastCount=ee.length),v[ae][ue]=$(ee.length,ee.mode)+4+n.getCharCountIndicator(ee.mode,I))}}E=Q}for(let L=0;L<E.length;L++)v[E[L]].end=0;return{map:v,table:b}}function N(R,I){let b;const v=n.getBestModeForData(R);if(b=n.from(I,v),b!==n.BYTE&&b.bit<v.bit)throw new Error('"'+R+'" cannot be encoded with mode '+n.toString(b)+`.
 Suggested mode is: `+n.toString(v));switch(b===n.KANJI&&!f.isKanjiModeEnabled()&&(b=n.BYTE),b){case n.NUMERIC:return new o(R);case n.ALPHANUMERIC:return new i(R);case n.KANJI:return new c(R);case n.BYTE:return new s(R)}}e.fromArray=function(I){return I.reduce(function(b,v){return typeof v=="string"?b.push(N(v,null)):v.data&&b.push(N(v.data,v.mode)),b},[])},e.fromString=function(I,b){const v=T(I,f.isKanjiModeEnabled()),E=A(v),L=D(E,b),F=l.find_path(L.map,"start","end"),Q=[];for(let re=1;re<F.length-1;re++)Q.push(L.table[F[re]].node);return e.fromArray(_(Q))},e.rawSplit=function(I){return e.fromArray(T(I,f.isKanjiModeEnabled()))}})(On);const Lt=se,fr=Bt,Gi=Mi,Ki=Ri,Qi=En,Xi=Sn,yr=Pn,wr=Nt,Zi=Oi,It=An,es=Rn,ts=$e,hr=On;function rs(e,n){const o=e.size,i=Xi.getPositions(n);for(let s=0;s<i.length;s++){const c=i[s][0],d=i[s][1];for(let f=-1;f<=7;f++)if(!(c+f<=-1||o<=c+f))for(let l=-1;l<=7;l++)d+l<=-1||o<=d+l||(f>=0&&f<=6&&(l===0||l===6)||l>=0&&l<=6&&(f===0||f===6)||f>=2&&f<=4&&l>=2&&l<=4?e.set(c+f,d+l,!0,!0):e.set(c+f,d+l,!1,!0))}}function ns(e){const n=e.size;for(let o=8;o<n-8;o++){const i=o%2===0;e.set(o,6,i,!0),e.set(6,o,i,!0)}}function os(e,n){const o=Qi.getPositions(n);for(let i=0;i<o.length;i++){const s=o[i][0],c=o[i][1];for(let d=-2;d<=2;d++)for(let f=-2;f<=2;f++)d===-2||d===2||f===-2||f===2||d===0&&f===0?e.set(s+d,c+f,!0,!0):e.set(s+d,c+f,!1,!0)}}function as(e,n){const o=e.size,i=It.getEncodedBits(n);let s,c,d;for(let f=0;f<18;f++)s=Math.floor(f/3),c=f%3+o-8-3,d=(i>>f&1)===1,e.set(s,c,d,!0),e.set(c,s,d,!0)}function gr(e,n,o){const i=e.size,s=es.getEncodedBits(n,o);let c,d;for(c=0;c<15;c++)d=(s>>c&1)===1,c<6?e.set(c,8,d,!0):c<8?e.set(c+1,8,d,!0):e.set(i-15+c,8,d,!0),c<8?e.set(8,i-c-1,d,!0):c<9?e.set(8,15-c-1+1,d,!0):e.set(8,15-c-1,d,!0);e.set(i-8,8,1,!0)}function is(e,n){const o=e.size;let i=-1,s=o-1,c=7,d=0;for(let f=o-1;f>0;f-=2)for(f===6&&f--;;){for(let l=0;l<2;l++)if(!e.isReserved(s,f-l)){let m=!1;d<n.length&&(m=(n[d]>>>c&1)===1),e.set(s,f-l,m),c--,c===-1&&(d++,c=7)}if(s+=i,s<0||o<=s){s-=i,i=-i;break}}}function ss(e,n,o){const i=new Gi;o.forEach(function(l){i.put(l.mode.bit,4),i.put(l.getLength(),ts.getCharCountIndicator(l.mode,e)),l.write(i)});const s=Lt.getSymbolTotalCodewords(e),c=wr.getTotalCodewordsCount(e,n),d=(s-c)*8;for(i.getLengthInBits()+4<=d&&i.put(0,4);i.getLengthInBits()%8!==0;)i.putBit(0);const f=(d-i.getLengthInBits())/8;for(let l=0;l<f;l++)i.put(l%2?17:236,8);return cs(i,e,n)}function cs(e,n,o){const i=Lt.getSymbolTotalCodewords(n),s=wr.getTotalCodewordsCount(n,o),c=i-s,d=wr.getBlocksCount(n,o),f=i%d,l=d-f,m=Math.floor(i/d),w=Math.floor(c/d),T=w+1,$=m-w,_=new Zi($);let A=0;const D=new Array(d),N=new Array(d);let R=0;const I=new Uint8Array(e.buffer);for(let F=0;F<d;F++){const Q=F<l?w:T;D[F]=I.slice(A,A+Q),N[F]=_.encode(D[F]),A+=Q,R=Math.max(R,Q)}const b=new Uint8Array(i);let v=0,E,L;for(E=0;E<R;E++)for(L=0;L<d;L++)E<D[L].length&&(b[v++]=D[L][E]);for(E=0;E<$;E++)for(L=0;L<d;L++)b[v++]=N[L][E];return b}function us(e,n,o,i){let s;if(Array.isArray(e))s=hr.fromArray(e);else if(typeof e=="string"){let m=n;if(!m){const w=hr.rawSplit(e);m=It.getBestVersionForData(w,o)}s=hr.fromString(e,m||40)}else throw new Error("Invalid data");const c=It.getBestVersionForData(s,o);if(!c)throw new Error("The amount of data is too big to be stored in a QR Code");if(!n)n=c;else if(n<c)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+c+`.
`);const d=ss(n,o,s),f=Lt.getSymbolSize(n),l=new Ki(f);return rs(l,n),ns(l),os(l,n),gr(l,o,0),n>=7&&as(l,n),is(l,d),isNaN(i)&&(i=yr.getBestMask(l,gr.bind(null,l,o))),yr.applyMask(i,l),gr(l,o,i),{modules:l,version:n,errorCorrectionLevel:o,maskPattern:i,segments:s}}Cn.create=function(n,o){if(typeof n>"u"||n==="")throw new Error("No input text");let i=fr.M,s,c;return typeof o<"u"&&(i=fr.from(o.errorCorrectionLevel,fr.M),s=It.from(o.version),c=yr.from(o.maskPattern),o.toSJISFunc&&Lt.setToSJISFunction(o.toSJISFunc)),us(n,s,i,c)};var kn={},Sr={};(function(e){function n(o){if(typeof o=="number"&&(o=o.toString()),typeof o!="string")throw new Error("Color should be defined as hex string");let i=o.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+o);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(c){return[c,c]}))),i.length===6&&i.push("F","F");const s=parseInt(i.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+i.slice(0,6).join("")}}e.getOptions=function(i){i||(i={}),i.color||(i.color={});const s=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,c=i.width&&i.width>=21?i.width:void 0,d=i.scale||4;return{width:c,scale:c?4:d,margin:s,color:{dark:n(i.color.dark||"#000000ff"),light:n(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},e.getScale=function(i,s){return s.width&&s.width>=i+s.margin*2?s.width/(i+s.margin*2):s.scale},e.getImageWidth=function(i,s){const c=e.getScale(i,s);return Math.floor((i+s.margin*2)*c)},e.qrToImageData=function(i,s,c){const d=s.modules.size,f=s.modules.data,l=e.getScale(d,c),m=Math.floor((d+c.margin*2)*l),w=c.margin*l,T=[c.color.light,c.color.dark];for(let $=0;$<m;$++)for(let _=0;_<m;_++){let A=($*m+_)*4,D=c.color.light;if($>=w&&_>=w&&$<m-w&&_<m-w){const N=Math.floor(($-w)/l),R=Math.floor((_-w)/l);D=T[f[N*d+R]?1:0]}i[A++]=D.r,i[A++]=D.g,i[A++]=D.b,i[A]=D.a}}})(Sr);(function(e){const n=Sr;function o(s,c,d){s.clearRect(0,0,c.width,c.height),c.style||(c.style={}),c.height=d,c.width=d,c.style.height=d+"px",c.style.width=d+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(c,d,f){let l=f,m=d;typeof l>"u"&&(!d||!d.getContext)&&(l=d,d=void 0),d||(m=i()),l=n.getOptions(l);const w=n.getImageWidth(c.modules.size,l),T=m.getContext("2d"),$=T.createImageData(w,w);return n.qrToImageData($.data,c,l),o(T,m,w),T.putImageData($,0,0),m},e.renderToDataURL=function(c,d,f){let l=f;typeof l>"u"&&(!d||!d.getContext)&&(l=d,d=void 0),l||(l={});const m=e.render(c,d,l),w=l.type||"image/png",T=l.rendererOpts||{};return m.toDataURL(w,T.quality)}})(kn);var Bn={};const ls=Sr;function sn(e,n){const o=e.a/255,i=n+'="'+e.hex+'"';return o<1?i+" "+n+'-opacity="'+o.toFixed(2).slice(1)+'"':i}function pr(e,n,o){let i=e+n;return typeof o<"u"&&(i+=" "+o),i}function ds(e,n,o){let i="",s=0,c=!1,d=0;for(let f=0;f<e.length;f++){const l=Math.floor(f%n),m=Math.floor(f/n);!l&&!c&&(c=!0),e[f]?(d++,f>0&&l>0&&e[f-1]||(i+=c?pr("M",l+o,.5+m+o):pr("m",s,0),s=0,c=!1),l+1<n&&e[f+1]||(i+=pr("h",d),d=0)):s++}return i}Bn.render=function(n,o,i){const s=ls.getOptions(o),c=n.modules.size,d=n.modules.data,f=c+s.margin*2,l=s.color.light.a?"<path "+sn(s.color.light,"fill")+' d="M0 0h'+f+"v"+f+'H0z"/>':"",m="<path "+sn(s.color.dark,"stroke")+' d="'+ds(d,c,s.margin)+'"/>',w='viewBox="0 0 '+f+" "+f+'"',$='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+w+' shape-rendering="crispEdges">'+l+m+`</svg>
`;return typeof i=="function"&&i(null,$),$};const fs=$i,br=Cn,Nn=kn,hs=Bn;function Pr(e,n,o,i,s){const c=[].slice.call(arguments,1),d=c.length,f=typeof c[d-1]=="function";if(!f&&!fs())throw new Error("Callback required as last argument");if(f){if(d<2)throw new Error("Too few arguments provided");d===2?(s=o,o=n,n=i=void 0):d===3&&(n.getContext&&typeof s>"u"?(s=i,i=void 0):(s=i,i=o,o=n,n=void 0))}else{if(d<1)throw new Error("Too few arguments provided");return d===1?(o=n,n=i=void 0):d===2&&!n.getContext&&(i=o,o=n,n=void 0),new Promise(function(l,m){try{const w=br.create(o,i);l(e(w,n,i))}catch(w){m(w)}})}try{const l=br.create(o,i);s(null,e(l,n,i))}catch(l){s(l)}}xe.create=br.create;xe.toCanvas=Pr.bind(null,Nn.render);xe.toDataURL=Pr.bind(null,Nn.renderToDataURL);xe.toString=Pr.bind(null,function(e,n,o){return hs.render(e,o)});var jn=(e,n,o)=>{if(!n.has(e))throw TypeError("Cannot "+o)},cn=(e,n,o)=>(jn(e,n,"read from private field"),o?o.call(e):n.get(e)),gs=(e,n,o)=>{if(n.has(e))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(e):n.set(e,o)},ps=(e,n,o,i)=>(jn(e,n,"write to private field"),n.set(e,o),o);const Ln=[["aztec","Aztec"],["code_128","Code128"],["code_39","Code39"],["code_93","Code93"],["codabar","Codabar"],["databar","DataBar"],["databar_expanded","DataBarExpanded"],["data_matrix","DataMatrix"],["dx_film_edge","DXFilmEdge"],["ean_13","EAN-13"],["ean_8","EAN-8"],["itf","ITF"],["maxi_code","MaxiCode"],["micro_qr_code","MicroQRCode"],["pdf417","PDF417"],["qr_code","QRCode"],["rm_qr_code","rMQRCode"],["upc_a","UPC-A"],["upc_e","UPC-E"],["linear_codes","Linear-Codes"],["matrix_codes","Matrix-Codes"]],ms=[...Ln,["unknown"]].map(e=>e[0]),Rt=new Map(Ln);function vs(e){for(const[n,o]of Rt)if(e===o)return n;return"unknown"}function ys(e){if(Fn(e))return{width:e.naturalWidth,height:e.naturalHeight};if(Un(e))return{width:e.width.baseVal.value,height:e.height.baseVal.value};if(xn(e))return{width:e.videoWidth,height:e.videoHeight};if(Wn(e))return{width:e.width,height:e.height};if(zn(e))return{width:e.displayWidth,height:e.displayHeight};if(Hn(e))return{width:e.width,height:e.height};if(Vn(e))return{width:e.width,height:e.height};throw new TypeError("The provided value is not of type '(Blob or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or ImageData or OffscreenCanvas or SVGImageElement or VideoFrame)'.")}function Fn(e){try{return e instanceof HTMLImageElement}catch{return!1}}function Un(e){try{return e instanceof SVGImageElement}catch{return!1}}function xn(e){try{return e instanceof HTMLVideoElement}catch{return!1}}function Hn(e){try{return e instanceof HTMLCanvasElement}catch{return!1}}function Wn(e){try{return e instanceof ImageBitmap}catch{return!1}}function Vn(e){try{return e instanceof OffscreenCanvas}catch{return!1}}function zn(e){try{return e instanceof VideoFrame}catch{return!1}}function Jn(e){try{return e instanceof Blob}catch{return!1}}function ws(e){try{return e instanceof ImageData}catch{return!1}}function bs(e,n){try{const o=new OffscreenCanvas(e,n);if(o.getContext("2d")instanceof OffscreenCanvasRenderingContext2D)return o;throw void 0}catch{const i=document.createElement("canvas");return i.width=e,i.height=n,i}}async function qn(e){if(Fn(e)&&!await Ss(e))throw new DOMException("Failed to load or decode HTMLImageElement.","InvalidStateError");if(Un(e)&&!await Ps(e))throw new DOMException("Failed to load or decode SVGImageElement.","InvalidStateError");if(zn(e)&&_s(e))throw new DOMException("VideoFrame is closed.","InvalidStateError");if(xn(e)&&(e.readyState===0||e.readyState===1))throw new DOMException("Invalid element or state.","InvalidStateError");if(Wn(e)&&As(e))throw new DOMException("The image source is detached.","InvalidStateError");const{width:n,height:o}=ys(e);if(n===0||o===0)return null;const i=bs(n,o).getContext("2d");i.drawImage(e,0,0);try{return i.getImageData(0,0,n,o)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function Cs(e){let n;try{if(globalThis.createImageBitmap)n=await createImageBitmap(e);else if(globalThis.Image){n=new Image;let o="";try{o=URL.createObjectURL(e),n.src=o,await n.decode()}finally{URL.revokeObjectURL(o)}}else return e}catch{throw new DOMException("Failed to load or decode Blob.","InvalidStateError")}return await qn(n)}function Ts(e){const{width:n,height:o}=e;if(n===0||o===0)return null;const i=e.getContext("2d");try{return i.getImageData(0,0,n,o)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function Es(e){if(Jn(e))return await Cs(e);if(ws(e)){if($s(e))throw new DOMException("The image data has been detached.","InvalidStateError");return e}return Hn(e)||Vn(e)?Ts(e):await qn(e)}async function Ss(e){try{return await e.decode(),!0}catch{return!1}}async function Ps(e){var n;try{return await((n=e.decode)==null?void 0:n.call(e)),!0}catch{return!1}}function _s(e){return e.format===null}function $s(e){return e.data.buffer.byteLength===0}function As(e){return e.width===0&&e.height===0}function un(e,n){return e instanceof DOMException?new DOMException(`${n}: ${e.message}`,e.name):e instanceof Error?new e.constructor(`${n}: ${e.message}`):new Error(`${n}: ${e}`)}const ln=["Aztec","Codabar","Code128","Code39","Code93","DataBar","DataBarExpanded","DataMatrix","DXFilmEdge","EAN-13","EAN-8","ITF","Linear-Codes","Matrix-Codes","MaxiCode","MicroQRCode","None","PDF417","QRCode","rMQRCode","UPC-A","UPC-E"];function Ms(e){return e.join("|")}function Rs(e){const n=dn(e);let o=0,i=ln.length-1;for(;o<=i;){const s=Math.floor((o+i)/2),c=ln[s],d=dn(c);if(d===n)return c;d<n?o=s+1:i=s-1}return"None"}function dn(e){return e.toLowerCase().replace(/_-\[\]/g,"")}function Ds(e,n){return e.Binarizer[n]}function Os(e,n){return e.CharacterSet[n]}const Is=["Text","Binary","Mixed","GS1","ISO15434","UnknownECI"];function ks(e){return Is[e.value]}function Bs(e,n){return e.EanAddOnSymbol[n]}function Ns(e,n){return e.TextMode[n]}const Je={formats:[],tryHarder:!0,tryRotate:!0,tryInvert:!0,tryDownscale:!0,binarizer:"LocalAverage",isPure:!1,downscaleFactor:3,downscaleThreshold:500,minLineCount:2,maxNumberOfSymbols:255,tryCode39ExtendedMode:!1,validateCode39CheckSum:!1,validateITFCheckSum:!1,returnCodabarStartEnd:!1,returnErrors:!1,eanAddOnSymbol:"Read",textMode:"Plain",characterSet:"Unknown"};function Yn(e,n){return{...n,formats:Ms(n.formats),binarizer:Ds(e,n.binarizer),eanAddOnSymbol:Bs(e,n.eanAddOnSymbol),textMode:Ns(e,n.textMode),characterSet:Os(e,n.characterSet)}}function Gn(e){return{...e,format:Rs(e.format),eccLevel:e.eccLevel,contentType:ks(e.contentType)}}const js={locateFile:(e,n)=>{const o=e.match(/_(.+?)\.wasm$/);return o?`https://fastly.jsdelivr.net/npm/zxing-wasm@1.1.3/dist/${o[1]}/${e}`:n+e}};let fn=new WeakMap;function _r(e,n){var o;const i=fn.get(e);if(i!=null&&i.modulePromise&&n===void 0)return i.modulePromise;const s=(o=i==null?void 0:i.moduleOverrides)!=null?o:js,c=e({...s});return fn.set(e,{moduleOverrides:s,modulePromise:c}),c}async function Ls(e,n,o=Je){const i={...Je,...o},s=await _r(e),{size:c}=n,d=new Uint8Array(await n.arrayBuffer()),f=s._malloc(c);s.HEAPU8.set(d,f);const l=s.readBarcodesFromImage(f,c,Yn(s,i));s._free(f);const m=[];for(let w=0;w<l.size();++w)m.push(Gn(l.get(w)));return m}async function Fs(e,n,o=Je){const i={...Je,...o},s=await _r(e),{data:c,width:d,height:f,data:{byteLength:l}}=n,m=s._malloc(l);s.HEAPU8.set(c,m);const w=s.readBarcodesFromPixmap(m,d,f,Yn(s,i));s._free(m);const T=[];for(let $=0;$<w.size();++$)T.push(Gn(w.get($)));return T}({...Je,formats:[...Je.formats]});var $r=(()=>{var e=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(n={}){var o=n,i,s;o.ready=new Promise((t,r)=>{i=t,s=r});var c=Object.assign({},o),d="./this.program",f=typeof window=="object",l=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var m="";function w(t){return o.locateFile?o.locateFile(t,m):m+t}var T;(f||l)&&(l?m=self.location.href:typeof document<"u"&&document.currentScript&&(m=document.currentScript.src),e&&(m=e),m.indexOf("blob:")!==0?m=m.substr(0,m.replace(/[?#].*/,"").lastIndexOf("/")+1):m="",l&&(T=t=>{var r=new XMLHttpRequest;return r.open("GET",t,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)})),o.print||console.log.bind(console);var $=o.printErr||console.error.bind(console);Object.assign(o,c),c=null,o.arguments&&o.arguments,o.thisProgram&&(d=o.thisProgram),o.quit&&o.quit;var _;o.wasmBinary&&(_=o.wasmBinary),typeof WebAssembly!="object"&&ie("no native wasm support detected");var A,D=!1,N,R,I,b,v,E,L,F;function Q(){var t=A.buffer;o.HEAP8=N=new Int8Array(t),o.HEAP16=I=new Int16Array(t),o.HEAPU8=R=new Uint8Array(t),o.HEAPU16=b=new Uint16Array(t),o.HEAP32=v=new Int32Array(t),o.HEAPU32=E=new Uint32Array(t),o.HEAPF32=L=new Float32Array(t),o.HEAPF64=F=new Float64Array(t)}var re=[],ee=[],ue=[];function be(){if(o.preRun)for(typeof o.preRun=="function"&&(o.preRun=[o.preRun]);o.preRun.length;)Ut(o.preRun.shift());Vt(re)}function ae(){Vt(ee)}function Ft(){if(o.postRun)for(typeof o.postRun=="function"&&(o.postRun=[o.postRun]);o.postRun.length;)qe(o.postRun.shift());Vt(ue)}function Ut(t){re.unshift(t)}function xt(t){ee.unshift(t)}function qe(t){ue.unshift(t)}var de=0,Ae=null;function lt(t){var r;de++,(r=o.monitorRunDependencies)===null||r===void 0||r.call(o,de)}function Ce(t){var r;if(de--,(r=o.monitorRunDependencies)===null||r===void 0||r.call(o,de),de==0&&Ae){var a=Ae;Ae=null,a()}}function ie(t){var r;(r=o.onAbort)===null||r===void 0||r.call(o,t),t="Aborted("+t+")",$(t),D=!0,t+=". Build with -sASSERTIONS for more info.";var a=new WebAssembly.RuntimeError(t);throw s(a),a}var Ht="data:application/octet-stream;base64,",dt=t=>t.startsWith(Ht),Te;Te="zxing_reader.wasm",dt(Te)||(Te=w(Te));function ft(t){if(t==Te&&_)return new Uint8Array(_);if(T)return T(t);throw"both async and sync fetching of the wasm failed"}function Wt(t){return!_&&(f||l)&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(r=>{if(!r.ok)throw"failed to load wasm binary file at '"+t+"'";return r.arrayBuffer()}).catch(()=>ft(t)):Promise.resolve().then(()=>ft(t))}function ht(t,r,a){return Wt(t).then(u=>WebAssembly.instantiate(u,r)).then(u=>u).then(a,u=>{$(`failed to asynchronously prepare wasm: ${u}`),ie(u)})}function fo(t,r,a,u){return!t&&typeof WebAssembly.instantiateStreaming=="function"&&!dt(r)&&typeof fetch=="function"?fetch(r,{credentials:"same-origin"}).then(h=>{var g=WebAssembly.instantiateStreaming(h,a);return g.then(u,function(p){return $(`wasm streaming compile failed: ${p}`),$("falling back to ArrayBuffer instantiation"),ht(r,a,u)})}):ht(r,a,u)}function ho(){var t={a:ei};function r(u,h){return G=u.exports,A=G.ia,Q(),jr=G.ma,xt(G.ja),Ce(),G}lt();function a(u){r(u.instance)}if(o.instantiateWasm)try{return o.instantiateWasm(t,r)}catch(u){$(`Module.instantiateWasm callback failed with error: ${u}`),s(u)}return fo(_,Te,t,a).catch(s),{}}var Vt=t=>{for(;t.length>0;)t.shift()(o)};o.noExitRuntime;var gt=[],pt=0,go=t=>{var r=new zt(t);return r.get_caught()||(r.set_caught(!0),pt--),r.set_rethrown(!1),gt.push(r),Qr(r.excPtr),r.get_exception_ptr()},ve=0,po=()=>{H(0,0);var t=gt.pop();Kr(t.excPtr),ve=0};function zt(t){this.excPtr=t,this.ptr=t-24,this.set_type=function(r){E[this.ptr+4>>2]=r},this.get_type=function(){return E[this.ptr+4>>2]},this.set_destructor=function(r){E[this.ptr+8>>2]=r},this.get_destructor=function(){return E[this.ptr+8>>2]},this.set_caught=function(r){r=r?1:0,N[this.ptr+12>>0]=r},this.get_caught=function(){return N[this.ptr+12>>0]!=0},this.set_rethrown=function(r){r=r?1:0,N[this.ptr+13>>0]=r},this.get_rethrown=function(){return N[this.ptr+13>>0]!=0},this.init=function(r,a){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(a)},this.set_adjusted_ptr=function(r){E[this.ptr+16>>2]=r},this.get_adjusted_ptr=function(){return E[this.ptr+16>>2]},this.get_exception_ptr=function(){var r=Zr(this.get_type());if(r)return E[this.excPtr>>2];var a=this.get_adjusted_ptr();return a!==0?a:this.excPtr}}var mo=t=>{throw ve||(ve=t),ve},Jt=t=>{var r=ve;if(!r)return et(0),0;var a=new zt(r);a.set_adjusted_ptr(r);var u=a.get_type();if(!u)return et(0),r;for(var h in t){var g=t[h];if(g===0||g===u)break;var p=a.ptr+16;if(Xr(g,u,p))return et(g),r}return et(u),r},vo=()=>Jt([]),yo=t=>Jt([t]),wo=(t,r)=>Jt([t,r]),bo=()=>{var t=gt.pop();t||ie("no exception to throw");var r=t.excPtr;throw t.get_rethrown()||(gt.push(t),t.set_rethrown(!0),t.set_caught(!1),pt++),ve=r,ve},Co=(t,r,a)=>{var u=new zt(t);throw u.init(r,a),ve=t,pt++,ve},To=()=>pt,mt={},qt=t=>{for(;t.length;){var r=t.pop(),a=t.pop();a(r)}};function Yt(t){return this.fromWireType(v[t>>2])}var Ie={},Me={},vt={},Ar,yt=t=>{throw new Ar(t)},Re=(t,r,a)=>{t.forEach(function(y){vt[y]=r});function u(y){var C=a(y);C.length!==t.length&&yt("Mismatched type converter count");for(var P=0;P<t.length;++P)fe(t[P],C[P])}var h=new Array(r.length),g=[],p=0;r.forEach((y,C)=>{Me.hasOwnProperty(y)?h[C]=Me[y]:(g.push(y),Ie.hasOwnProperty(y)||(Ie[y]=[]),Ie[y].push(()=>{h[C]=Me[y],++p,p===g.length&&u(h)}))}),g.length===0&&u(h)},Eo=t=>{var r=mt[t];delete mt[t];var a=r.rawConstructor,u=r.rawDestructor,h=r.fields,g=h.map(p=>p.getterReturnType).concat(h.map(p=>p.setterArgumentType));Re([t],g,p=>{var y={};return h.forEach((C,P)=>{var M=C.fieldName,k=p[P],B=C.getter,j=C.getterContext,W=p[P+h.length],q=C.setter,x=C.setterContext;y[M]={read:Z=>k.fromWireType(B(j,Z)),write:(Z,S)=>{var O=[];q(x,Z,W.toWireType(O,S)),qt(O)}}}),[{name:r.name,fromWireType:C=>{var P={};for(var M in y)P[M]=y[M].read(C);return u(C),P},toWireType:(C,P)=>{for(var M in y)if(!(M in P))throw new TypeError(`Missing field: "${M}"`);var k=a();for(M in y)y[M].write(k,P[M]);return C!==null&&C.push(u,k),k},argPackAdvance:he,readValueFromPointer:Yt,destructorFunction:u}]})},So=(t,r,a,u,h)=>{},Po=()=>{for(var t=new Array(256),r=0;r<256;++r)t[r]=String.fromCharCode(r);Mr=t},Mr,X=t=>{for(var r="",a=t;R[a];)r+=Mr[R[a++]];return r},ke,U=t=>{throw new ke(t)};function _o(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var u=r.name;if(t||U(`type "${u}" must have a positive integer typeid pointer`),Me.hasOwnProperty(t)){if(a.ignoreDuplicateRegistrations)return;U(`Cannot register type '${u}' twice`)}if(Me[t]=r,delete vt[t],Ie.hasOwnProperty(t)){var h=Ie[t];delete Ie[t],h.forEach(g=>g())}}function fe(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!("argPackAdvance"in r))throw new TypeError("registerType registeredInstance requires argPackAdvance");return _o(t,r,a)}var he=8,$o=(t,r,a,u)=>{r=X(r),fe(t,{name:r,fromWireType:function(h){return!!h},toWireType:function(h,g){return g?a:u},argPackAdvance:he,readValueFromPointer:function(h){return this.fromWireType(R[h])},destructorFunction:null})},Ao=t=>({count:t.count,deleteScheduled:t.deleteScheduled,preservePointerOnDelete:t.preservePointerOnDelete,ptr:t.ptr,ptrType:t.ptrType,smartPtr:t.smartPtr,smartPtrType:t.smartPtrType}),Gt=t=>{function r(a){return a.$$.ptrType.registeredClass.name}U(r(t)+" instance already deleted")},Kt=!1,Rr=t=>{},Mo=t=>{t.smartPtr?t.smartPtrType.rawDestructor(t.smartPtr):t.ptrType.registeredClass.rawDestructor(t.ptr)},Dr=t=>{t.count.value-=1;var r=t.count.value===0;r&&Mo(t)},Or=(t,r,a)=>{if(r===a)return t;if(a.baseClass===void 0)return null;var u=Or(t,r,a.baseClass);return u===null?null:a.downcast(u)},Ir={},Ro=()=>Object.keys(Ke).length,Do=()=>{var t=[];for(var r in Ke)Ke.hasOwnProperty(r)&&t.push(Ke[r]);return t},Ye=[],Qt=()=>{for(;Ye.length;){var t=Ye.pop();t.$$.deleteScheduled=!1,t.delete()}},Ge,Oo=t=>{Ge=t,Ye.length&&Ge&&Ge(Qt)},Io=()=>{o.getInheritedInstanceCount=Ro,o.getLiveInheritedInstances=Do,o.flushPendingDeletes=Qt,o.setDelayFunction=Oo},Ke={},ko=(t,r)=>{for(r===void 0&&U("ptr should not be undefined");t.baseClass;)r=t.upcast(r),t=t.baseClass;return r},Bo=(t,r)=>(r=ko(t,r),Ke[r]),wt=(t,r)=>{(!r.ptrType||!r.ptr)&&yt("makeClassHandle requires ptr and ptrType");var a=!!r.smartPtrType,u=!!r.smartPtr;return a!==u&&yt("Both smartPtrType and smartPtr must be specified"),r.count={value:1},Qe(Object.create(t,{$$:{value:r,writable:!0}}))};function No(t){var r=this.getPointee(t);if(!r)return this.destructor(t),null;var a=Bo(this.registeredClass,r);if(a!==void 0){if(a.$$.count.value===0)return a.$$.ptr=r,a.$$.smartPtr=t,a.clone();var u=a.clone();return this.destructor(t),u}function h(){return this.isSmartPointer?wt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:r,smartPtrType:this,smartPtr:t}):wt(this.registeredClass.instancePrototype,{ptrType:this,ptr:t})}var g=this.registeredClass.getActualType(r),p=Ir[g];if(!p)return h.call(this);var y;this.isConst?y=p.constPointerType:y=p.pointerType;var C=Or(r,this.registeredClass,y.registeredClass);return C===null?h.call(this):this.isSmartPointer?wt(y.registeredClass.instancePrototype,{ptrType:y,ptr:C,smartPtrType:this,smartPtr:t}):wt(y.registeredClass.instancePrototype,{ptrType:y,ptr:C})}var Qe=t=>typeof FinalizationRegistry>"u"?(Qe=r=>r,t):(Kt=new FinalizationRegistry(r=>{Dr(r.$$)}),Qe=r=>{var a=r.$$,u=!!a.smartPtr;if(u){var h={$$:a};Kt.register(r,h,r)}return r},Rr=r=>Kt.unregister(r),Qe(t)),jo=()=>{Object.assign(bt.prototype,{isAliasOf(t){if(!(this instanceof bt)||!(t instanceof bt))return!1;var r=this.$$.ptrType.registeredClass,a=this.$$.ptr;t.$$=t.$$;for(var u=t.$$.ptrType.registeredClass,h=t.$$.ptr;r.baseClass;)a=r.upcast(a),r=r.baseClass;for(;u.baseClass;)h=u.upcast(h),u=u.baseClass;return r===u&&a===h},clone(){if(this.$$.ptr||Gt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var t=Qe(Object.create(Object.getPrototypeOf(this),{$$:{value:Ao(this.$$)}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t},delete(){this.$$.ptr||Gt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&U("Object already scheduled for deletion"),Rr(this),Dr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||Gt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&U("Object already scheduled for deletion"),Ye.push(this),Ye.length===1&&Ge&&Ge(Qt),this.$$.deleteScheduled=!0,this}})};function bt(){}var Xe=(t,r)=>Object.defineProperty(r,"name",{value:t}),kr=(t,r,a)=>{if(t[r].overloadTable===void 0){var u=t[r];t[r]=function(){return t[r].overloadTable.hasOwnProperty(arguments.length)||U(`Function '${a}' called with an invalid number of arguments (${arguments.length}) - expects one of (${t[r].overloadTable})!`),t[r].overloadTable[arguments.length].apply(this,arguments)},t[r].overloadTable=[],t[r].overloadTable[u.argCount]=u}},Xt=(t,r,a)=>{o.hasOwnProperty(t)?((a===void 0||o[t].overloadTable!==void 0&&o[t].overloadTable[a]!==void 0)&&U(`Cannot register public name '${t}' twice`),kr(o,t,t),o.hasOwnProperty(a)&&U(`Cannot register multiple overloads of a function with the same number of arguments (${a})!`),o[t].overloadTable[a]=r):(o[t]=r,a!==void 0&&(o[t].numArguments=a))},Lo=48,Fo=57,Uo=t=>{if(t===void 0)return"_unknown";t=t.replace(/[^a-zA-Z0-9_]/g,"$");var r=t.charCodeAt(0);return r>=Lo&&r<=Fo?`_${t}`:t};function xo(t,r,a,u,h,g,p,y){this.name=t,this.constructor=r,this.instancePrototype=a,this.rawDestructor=u,this.baseClass=h,this.getActualType=g,this.upcast=p,this.downcast=y,this.pureVirtualFunctions=[]}var Zt=(t,r,a)=>{for(;r!==a;)r.upcast||U(`Expected null or instance of ${a.name}, got an instance of ${r.name}`),t=r.upcast(t),r=r.baseClass;return t};function Ho(t,r){if(r===null)return this.isReference&&U(`null is not a valid ${this.name}`),0;r.$$||U(`Cannot pass "${or(r)}" as a ${this.name}`),r.$$.ptr||U(`Cannot pass deleted object as a pointer of type ${this.name}`);var a=r.$$.ptrType.registeredClass,u=Zt(r.$$.ptr,a,this.registeredClass);return u}function Wo(t,r){var a;if(r===null)return this.isReference&&U(`null is not a valid ${this.name}`),this.isSmartPointer?(a=this.rawConstructor(),t!==null&&t.push(this.rawDestructor,a),a):0;(!r||!r.$$)&&U(`Cannot pass "${or(r)}" as a ${this.name}`),r.$$.ptr||U(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&r.$$.ptrType.isConst&&U(`Cannot convert argument of type ${r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name} to parameter type ${this.name}`);var u=r.$$.ptrType.registeredClass;if(a=Zt(r.$$.ptr,u,this.registeredClass),this.isSmartPointer)switch(r.$$.smartPtr===void 0&&U("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:r.$$.smartPtrType===this?a=r.$$.smartPtr:U(`Cannot convert argument of type ${r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:a=r.$$.smartPtr;break;case 2:if(r.$$.smartPtrType===this)a=r.$$.smartPtr;else{var h=r.clone();a=this.rawShare(a,ye.toHandle(()=>h.delete())),t!==null&&t.push(this.rawDestructor,a)}break;default:U("Unsupporting sharing policy")}return a}function Vo(t,r){if(r===null)return this.isReference&&U(`null is not a valid ${this.name}`),0;r.$$||U(`Cannot pass "${or(r)}" as a ${this.name}`),r.$$.ptr||U(`Cannot pass deleted object as a pointer of type ${this.name}`),r.$$.ptrType.isConst&&U(`Cannot convert argument of type ${r.$$.ptrType.name} to parameter type ${this.name}`);var a=r.$$.ptrType.registeredClass,u=Zt(r.$$.ptr,a,this.registeredClass);return u}function Br(t){return this.fromWireType(E[t>>2])}var zo=()=>{Object.assign(Ct.prototype,{getPointee(t){return this.rawGetPointee&&(t=this.rawGetPointee(t)),t},destructor(t){var r;(r=this.rawDestructor)===null||r===void 0||r.call(this,t)},argPackAdvance:he,readValueFromPointer:Br,deleteObject(t){t!==null&&t.delete()},fromWireType:No})};function Ct(t,r,a,u,h,g,p,y,C,P,M){this.name=t,this.registeredClass=r,this.isReference=a,this.isConst=u,this.isSmartPointer=h,this.pointeeType=g,this.sharingPolicy=p,this.rawGetPointee=y,this.rawConstructor=C,this.rawShare=P,this.rawDestructor=M,!h&&r.baseClass===void 0?u?(this.toWireType=Ho,this.destructorFunction=null):(this.toWireType=Vo,this.destructorFunction=null):this.toWireType=Wo}var Nr=(t,r,a)=>{o.hasOwnProperty(t)||yt("Replacing nonexistant public symbol"),o[t].overloadTable!==void 0&&a!==void 0?o[t].overloadTable[a]=r:(o[t]=r,o[t].argCount=a)},Jo=(t,r,a)=>{var u=o["dynCall_"+t];return a&&a.length?u.apply(null,[r].concat(a)):u.call(null,r)},Tt=[],jr,V=t=>{var r=Tt[t];return r||(t>=Tt.length&&(Tt.length=t+1),Tt[t]=r=jr.get(t)),r},qo=(t,r,a)=>{if(t.includes("j"))return Jo(t,r,a);var u=V(r).apply(null,a);return u},Yo=(t,r)=>{var a=[];return function(){return a.length=0,Object.assign(a,arguments),qo(t,r,a)}},le=(t,r)=>{t=X(t);function a(){return t.includes("j")?Yo(t,r):V(r)}var u=a();return typeof u!="function"&&U(`unknown function pointer with signature ${t}: ${r}`),u},Go=(t,r)=>{var a=Xe(r,function(u){this.name=r,this.message=u;var h=new Error(u).stack;h!==void 0&&(this.stack=this.toString()+`
`+h.replace(/^Error(:[^\n]*)?\n/,""))});return a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},a},Lr,Fr=t=>{var r=Gr(t),a=X(r);return we(r),a},Et=(t,r)=>{var a=[],u={};function h(g){if(!u[g]&&!Me[g]){if(vt[g]){vt[g].forEach(h);return}a.push(g),u[g]=!0}}throw r.forEach(h),new Lr(`${t}: `+a.map(Fr).join([", "]))},Ko=(t,r,a,u,h,g,p,y,C,P,M,k,B)=>{M=X(M),g=le(h,g),y&&(y=le(p,y)),P&&(P=le(C,P)),B=le(k,B);var j=Uo(M);Xt(j,function(){Et(`Cannot construct ${M} due to unbound types`,[u])}),Re([t,r,a],u?[u]:[],function(W){W=W[0];var q,x;u?(q=W.registeredClass,x=q.instancePrototype):x=bt.prototype;var Z=Xe(M,function(){if(Object.getPrototypeOf(this)!==S)throw new ke("Use 'new' to construct "+M);if(O.constructor_body===void 0)throw new ke(M+" has no accessible constructor");var nn=O.constructor_body[arguments.length];if(nn===void 0)throw new ke(`Tried to invoke ctor of ${M} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(O.constructor_body).toString()}) parameters instead!`);return nn.apply(this,arguments)}),S=Object.create(x,{constructor:{value:Z}});Z.prototype=S;var O=new xo(M,Z,S,B,q,g,y,P);if(O.baseClass){var Y,K;(K=(Y=O.baseClass).__derivedClasses)!==null&&K!==void 0||(Y.__derivedClasses=[]),O.baseClass.__derivedClasses.push(O)}var Be=new Ct(M,O,!0,!1,!1),_t=new Ct(M+"*",O,!1,!1,!1),rn=new Ct(M+" const*",O,!1,!0,!1);return Ir[t]={pointerType:_t,constPointerType:rn},Nr(j,Z),[Be,_t,rn]})},er=(t,r)=>{for(var a=[],u=0;u<t;u++)a.push(E[r+u*4>>2]);return a};function Qo(t){for(var r=1;r<t.length;++r)if(t[r]!==null&&t[r].destructorFunction===void 0)return!0;return!1}function tr(t,r,a,u,h,g){var p=r.length;p<2&&U("argTypes array size mismatch! Must at least get return value and 'this' types!");var y=r[1]!==null&&a!==null,C=Qo(r),P=r[0].name!=="void",M=p-2,k=new Array(M),B=[],j=[],W=function(){arguments.length!==M&&U(`function ${t} called with ${arguments.length} arguments, expected ${M}`),j.length=0;var q;B.length=y?2:1,B[0]=h,y&&(q=r[1].toWireType(j,this),B[1]=q);for(var x=0;x<M;++x)k[x]=r[x+2].toWireType(j,arguments[x]),B.push(k[x]);var Z=u.apply(null,B);function S(O){if(C)qt(j);else for(var Y=y?1:2;Y<r.length;Y++){var K=Y===1?q:k[Y-2];r[Y].destructorFunction!==null&&r[Y].destructorFunction(K)}if(P)return r[0].fromWireType(O)}return S(Z)};return Xe(t,W)}var Xo=(t,r,a,u,h,g)=>{var p=er(r,a);h=le(u,h),Re([],[t],function(y){y=y[0];var C=`constructor ${y.name}`;if(y.registeredClass.constructor_body===void 0&&(y.registeredClass.constructor_body=[]),y.registeredClass.constructor_body[r-1]!==void 0)throw new ke(`Cannot register multiple constructors with identical number of parameters (${r-1}) for class '${y.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return y.registeredClass.constructor_body[r-1]=()=>{Et(`Cannot construct ${y.name} due to unbound types`,p)},Re([],p,P=>(P.splice(1,0,null),y.registeredClass.constructor_body[r-1]=tr(C,P,null,h,g),[])),[]})},Ur=t=>{t=t.trim();const r=t.indexOf("(");return r!==-1?t.substr(0,r):t},Zo=(t,r,a,u,h,g,p,y,C)=>{var P=er(a,u);r=X(r),r=Ur(r),g=le(h,g),Re([],[t],function(M){M=M[0];var k=`${M.name}.${r}`;r.startsWith("@@")&&(r=Symbol[r.substring(2)]),y&&M.registeredClass.pureVirtualFunctions.push(r);function B(){Et(`Cannot call ${k} due to unbound types`,P)}var j=M.registeredClass.instancePrototype,W=j[r];return W===void 0||W.overloadTable===void 0&&W.className!==M.name&&W.argCount===a-2?(B.argCount=a-2,B.className=M.name,j[r]=B):(kr(j,r,k),j[r].overloadTable[a-2]=B),Re([],P,function(q){var x=tr(k,q,M,g,p);return j[r].overloadTable===void 0?(x.argCount=a-2,j[r]=x):j[r].overloadTable[a-2]=x,[]}),[]})};function ea(){Object.assign(xr.prototype,{get(t){return this.allocated[t]},has(t){return this.allocated[t]!==void 0},allocate(t){var r=this.freelist.pop()||this.allocated.length;return this.allocated[r]=t,r},free(t){this.allocated[t]=void 0,this.freelist.push(t)}})}function xr(){this.allocated=[void 0],this.freelist=[]}var ce=new xr,rr=t=>{t>=ce.reserved&&--ce.get(t).refcount===0&&ce.free(t)},ta=()=>{for(var t=0,r=ce.reserved;r<ce.allocated.length;++r)ce.allocated[r]!==void 0&&++t;return t},ra=()=>{ce.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),ce.reserved=ce.allocated.length,o.count_emval_handles=ta},ye={toValue:t=>(t||U("Cannot use deleted val. handle = "+t),ce.get(t).value),toHandle:t=>{switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return ce.allocate({refcount:1,value:t})}}},na=(t,r)=>{r=X(r),fe(t,{name:r,fromWireType:a=>{var u=ye.toValue(a);return rr(a),u},toWireType:(a,u)=>ye.toHandle(u),argPackAdvance:he,readValueFromPointer:Yt,destructorFunction:null})},oa=(t,r,a)=>{switch(r){case 1:return a?function(u){return this.fromWireType(N[u>>0])}:function(u){return this.fromWireType(R[u>>0])};case 2:return a?function(u){return this.fromWireType(I[u>>1])}:function(u){return this.fromWireType(b[u>>1])};case 4:return a?function(u){return this.fromWireType(v[u>>2])}:function(u){return this.fromWireType(E[u>>2])};default:throw new TypeError(`invalid integer width (${r}): ${t}`)}},aa=(t,r,a,u)=>{r=X(r);function h(){}h.values={},fe(t,{name:r,constructor:h,fromWireType:function(g){return this.constructor.values[g]},toWireType:(g,p)=>p.value,argPackAdvance:he,readValueFromPointer:oa(r,a,u),destructorFunction:null}),Xt(r,h)},nr=(t,r)=>{var a=Me[t];return a===void 0&&U(r+" has unknown type "+Fr(t)),a},ia=(t,r,a)=>{var u=nr(t,"enum");r=X(r);var h=u.constructor,g=Object.create(u.constructor.prototype,{value:{value:a},constructor:{value:Xe(`${u.name}_${r}`,function(){})}});h.values[a]=g,h[r]=g},or=t=>{if(t===null)return"null";var r=typeof t;return r==="object"||r==="array"||r==="function"?t.toString():""+t},sa=(t,r)=>{switch(r){case 4:return function(a){return this.fromWireType(L[a>>2])};case 8:return function(a){return this.fromWireType(F[a>>3])};default:throw new TypeError(`invalid float width (${r}): ${t}`)}},ca=(t,r,a)=>{r=X(r),fe(t,{name:r,fromWireType:u=>u,toWireType:(u,h)=>h,argPackAdvance:he,readValueFromPointer:sa(r,a),destructorFunction:null})},ua=(t,r,a,u,h,g,p)=>{var y=er(r,a);t=X(t),t=Ur(t),h=le(u,h),Xt(t,function(){Et(`Cannot call ${t} due to unbound types`,y)},r-1),Re([],y,function(C){var P=[C[0],null].concat(C.slice(1));return Nr(t,tr(t,P,null,h,g),r-1),[]})},la=(t,r,a)=>{switch(r){case 1:return a?u=>N[u>>0]:u=>R[u>>0];case 2:return a?u=>I[u>>1]:u=>b[u>>1];case 4:return a?u=>v[u>>2]:u=>E[u>>2];default:throw new TypeError(`invalid integer width (${r}): ${t}`)}},da=(t,r,a,u,h)=>{r=X(r);var g=M=>M;if(u===0){var p=32-8*a;g=M=>M<<p>>>p}var y=r.includes("unsigned"),C=(M,k)=>{},P;y?P=function(M,k){return C(k,this.name),k>>>0}:P=function(M,k){return C(k,this.name),k},fe(t,{name:r,fromWireType:g,toWireType:P,argPackAdvance:he,readValueFromPointer:la(r,a,u!==0),destructorFunction:null})},fa=(t,r,a)=>{var u=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],h=u[r];function g(p){var y=E[p>>2],C=E[p+4>>2];return new h(N.buffer,C,y)}a=X(a),fe(t,{name:a,fromWireType:g,argPackAdvance:he,readValueFromPointer:g},{ignoreDuplicateRegistrations:!0})},Hr=(t,r,a,u)=>{if(!(u>0))return 0;for(var h=a,g=a+u-1,p=0;p<t.length;++p){var y=t.charCodeAt(p);if(y>=55296&&y<=57343){var C=t.charCodeAt(++p);y=65536+((y&1023)<<10)|C&1023}if(y<=127){if(a>=g)break;r[a++]=y}else if(y<=2047){if(a+1>=g)break;r[a++]=192|y>>6,r[a++]=128|y&63}else if(y<=65535){if(a+2>=g)break;r[a++]=224|y>>12,r[a++]=128|y>>6&63,r[a++]=128|y&63}else{if(a+3>=g)break;r[a++]=240|y>>18,r[a++]=128|y>>12&63,r[a++]=128|y>>6&63,r[a++]=128|y&63}}return r[a]=0,a-h},ha=(t,r,a)=>Hr(t,R,r,a),Wr=t=>{for(var r=0,a=0;a<t.length;++a){var u=t.charCodeAt(a);u<=127?r++:u<=2047?r+=2:u>=55296&&u<=57343?(r+=4,++a):r+=3}return r},Vr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,ga=(t,r,a)=>{for(var u=r+a,h=r;t[h]&&!(h>=u);)++h;if(h-r>16&&t.buffer&&Vr)return Vr.decode(t.subarray(r,h));for(var g="";r<h;){var p=t[r++];if(!(p&128)){g+=String.fromCharCode(p);continue}var y=t[r++]&63;if((p&224)==192){g+=String.fromCharCode((p&31)<<6|y);continue}var C=t[r++]&63;if((p&240)==224?p=(p&15)<<12|y<<6|C:p=(p&7)<<18|y<<12|C<<6|t[r++]&63,p<65536)g+=String.fromCharCode(p);else{var P=p-65536;g+=String.fromCharCode(55296|P>>10,56320|P&1023)}}return g},ar=(t,r)=>t?ga(R,t,r):"",pa=(t,r)=>{r=X(r);var a=r==="std::string";fe(t,{name:r,fromWireType(u){var h=E[u>>2],g=u+4,p;if(a)for(var y=g,C=0;C<=h;++C){var P=g+C;if(C==h||R[P]==0){var M=P-y,k=ar(y,M);p===void 0?p=k:(p+="\0",p+=k),y=P+1}}else{for(var B=new Array(h),C=0;C<h;++C)B[C]=String.fromCharCode(R[g+C]);p=B.join("")}return we(u),p},toWireType(u,h){h instanceof ArrayBuffer&&(h=new Uint8Array(h));var g,p=typeof h=="string";p||h instanceof Uint8Array||h instanceof Uint8ClampedArray||h instanceof Int8Array||U("Cannot pass non-string to std::string"),a&&p?g=Wr(h):g=h.length;var y=cr(4+g+1),C=y+4;if(E[y>>2]=g,a&&p)ha(h,C,g+1);else if(p)for(var P=0;P<g;++P){var M=h.charCodeAt(P);M>255&&(we(C),U("String has UTF-16 code units that do not fit in 8 bits")),R[C+P]=M}else for(var P=0;P<g;++P)R[C+P]=h[P];return u!==null&&u.push(we,y),y},argPackAdvance:he,readValueFromPointer:Br,destructorFunction(u){we(u)}})},zr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,ma=(t,r)=>{for(var a=t,u=a>>1,h=u+r/2;!(u>=h)&&b[u];)++u;if(a=u<<1,a-t>32&&zr)return zr.decode(R.subarray(t,a));for(var g="",p=0;!(p>=r/2);++p){var y=I[t+p*2>>1];if(y==0)break;g+=String.fromCharCode(y)}return g},va=(t,r,a)=>{var u;if((u=a)!==null&&u!==void 0||(a=2147483647),a<2)return 0;a-=2;for(var h=r,g=a<t.length*2?a/2:t.length,p=0;p<g;++p){var y=t.charCodeAt(p);I[r>>1]=y,r+=2}return I[r>>1]=0,r-h},ya=t=>t.length*2,wa=(t,r)=>{for(var a=0,u="";!(a>=r/4);){var h=v[t+a*4>>2];if(h==0)break;if(++a,h>=65536){var g=h-65536;u+=String.fromCharCode(55296|g>>10,56320|g&1023)}else u+=String.fromCharCode(h)}return u},ba=(t,r,a)=>{var u;if((u=a)!==null&&u!==void 0||(a=2147483647),a<4)return 0;for(var h=r,g=h+a-4,p=0;p<t.length;++p){var y=t.charCodeAt(p);if(y>=55296&&y<=57343){var C=t.charCodeAt(++p);y=65536+((y&1023)<<10)|C&1023}if(v[r>>2]=y,r+=4,r+4>g)break}return v[r>>2]=0,r-h},Ca=t=>{for(var r=0,a=0;a<t.length;++a){var u=t.charCodeAt(a);u>=55296&&u<=57343&&++a,r+=4}return r},Ta=(t,r,a)=>{a=X(a);var u,h,g,p,y;r===2?(u=ma,h=va,p=ya,g=()=>b,y=1):r===4&&(u=wa,h=ba,p=Ca,g=()=>E,y=2),fe(t,{name:a,fromWireType:C=>{for(var P=E[C>>2],M=g(),k,B=C+4,j=0;j<=P;++j){var W=C+4+j*r;if(j==P||M[W>>y]==0){var q=W-B,x=u(B,q);k===void 0?k=x:(k+="\0",k+=x),B=W+r}}return we(C),k},toWireType:(C,P)=>{typeof P!="string"&&U(`Cannot pass non-string to C++ string type ${a}`);var M=p(P),k=cr(4+M+r);return E[k>>2]=M>>y,h(P,k+4,M+r),C!==null&&C.push(we,k),k},argPackAdvance:he,readValueFromPointer:Yt,destructorFunction(C){we(C)}})},Ea=(t,r,a,u,h,g)=>{mt[t]={name:X(r),rawConstructor:le(a,u),rawDestructor:le(h,g),fields:[]}},Sa=(t,r,a,u,h,g,p,y,C,P)=>{mt[t].fields.push({fieldName:X(r),getterReturnType:a,getter:le(u,h),getterContext:g,setterArgumentType:p,setter:le(y,C),setterContext:P})},Pa=(t,r)=>{r=X(r),fe(t,{isVoid:!0,name:r,argPackAdvance:0,fromWireType:()=>{},toWireType:(a,u)=>{}})},ir=[],_a=(t,r,a,u)=>(t=ir[t],r=ye.toValue(r),t(null,r,a,u)),$a={},Aa=t=>{var r=$a[t];return r===void 0?X(t):r},Jr=()=>{if(typeof globalThis=="object")return globalThis;function t(r){r.$$$embind_global$$$=r;var a=typeof $$$embind_global$$$=="object"&&r.$$$embind_global$$$==r;return a||delete r.$$$embind_global$$$,a}if(typeof $$$embind_global$$$=="object"||(typeof global=="object"&&t(global)?$$$embind_global$$$=global:typeof self=="object"&&t(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},Ma=t=>t===0?ye.toHandle(Jr()):(t=Aa(t),ye.toHandle(Jr()[t])),Ra=t=>{var r=ir.length;return ir.push(t),r},Da=(t,r)=>{for(var a=new Array(t),u=0;u<t;++u)a[u]=nr(E[r+u*4>>2],"parameter "+u);return a},Oa=Reflect.construct,Ia=(t,r,a)=>{var u=[],h=t.toWireType(u,a);return u.length&&(E[r>>2]=ye.toHandle(u)),h},ka=(t,r,a)=>{var u=Da(t,r),h=u.shift();t--;var g=new Array(t),p=(C,P,M,k)=>{for(var B=0,j=0;j<t;++j)g[j]=u[j].readValueFromPointer(k+B),B+=u[j].argPackAdvance;for(var W=a===1?Oa(P,g):P.apply(C,g),j=0;j<t;++j){var q,x;(q=(x=u[j]).deleteObject)===null||q===void 0||q.call(x,g[j])}return Ia(h,M,W)},y=`methodCaller<(${u.map(C=>C.name).join(", ")}) => ${h.name}>`;return Ra(Xe(y,p))},Ba=t=>{t>4&&(ce.get(t).refcount+=1)},Na=t=>{var r=ye.toValue(t);qt(r),rr(t)},ja=(t,r)=>{t=nr(t,"_emval_take_value");var a=t.readValueFromPointer(r);return ye.toHandle(a)},La=()=>{ie("")},Fa=(t,r,a)=>R.copyWithin(t,r,r+a),Ua=()=>2147483648,xa=t=>{var r=A.buffer,a=(t-r.byteLength+65535)/65536;try{return A.grow(a),Q(),1}catch{}},Ha=t=>{var r=R.length;t>>>=0;var a=Ua();if(t>a)return!1;for(var u=(C,P)=>C+(P-C%P)%P,h=1;h<=4;h*=2){var g=r*(1+.2/h);g=Math.min(g,t+100663296);var p=Math.min(a,u(Math.max(t,g),65536)),y=xa(p);if(y)return!0}return!1},sr={},Wa=()=>d||"./this.program",Ze=()=>{if(!Ze.strings){var t=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:t,_:Wa()};for(var a in sr)sr[a]===void 0?delete r[a]:r[a]=sr[a];var u=[];for(var a in r)u.push(`${a}=${r[a]}`);Ze.strings=u}return Ze.strings},Va=(t,r)=>{for(var a=0;a<t.length;++a)N[r++>>0]=t.charCodeAt(a);N[r>>0]=0},za=(t,r)=>{var a=0;return Ze().forEach((u,h)=>{var g=r+a;E[t+h*4>>2]=g,Va(u,g),a+=u.length+1}),0},Ja=(t,r)=>{var a=Ze();E[t>>2]=a.length;var u=0;return a.forEach(h=>u+=h.length+1),E[r>>2]=u,0},qa=t=>t,St=t=>t%4===0&&(t%100!==0||t%400===0),Ya=(t,r)=>{for(var a=0,u=0;u<=r;a+=t[u++]);return a},qr=[31,29,31,30,31,30,31,31,30,31,30,31],Yr=[31,28,31,30,31,30,31,31,30,31,30,31],Ga=(t,r)=>{for(var a=new Date(t.getTime());r>0;){var u=St(a.getFullYear()),h=a.getMonth(),g=(u?qr:Yr)[h];if(r>g-a.getDate())r-=g-a.getDate()+1,a.setDate(1),h<11?a.setMonth(h+1):(a.setMonth(0),a.setFullYear(a.getFullYear()+1));else return a.setDate(a.getDate()+r),a}return a};function Ka(t,r,a){var u=Wr(t)+1,h=new Array(u);return Hr(t,h,0,h.length),h}var Qa=(t,r)=>{N.set(t,r)},Xa=(t,r,a,u)=>{var h=E[u+40>>2],g={tm_sec:v[u>>2],tm_min:v[u+4>>2],tm_hour:v[u+8>>2],tm_mday:v[u+12>>2],tm_mon:v[u+16>>2],tm_year:v[u+20>>2],tm_wday:v[u+24>>2],tm_yday:v[u+28>>2],tm_isdst:v[u+32>>2],tm_gmtoff:v[u+36>>2],tm_zone:h?ar(h):""},p=ar(a),y={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var C in y)p=p.replace(new RegExp(C,"g"),y[C]);var P=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],M=["January","February","March","April","May","June","July","August","September","October","November","December"];function k(S,O,Y){for(var K=typeof S=="number"?S.toString():S||"";K.length<O;)K=Y[0]+K;return K}function B(S,O){return k(S,O,"0")}function j(S,O){function Y(Be){return Be<0?-1:Be>0?1:0}var K;return(K=Y(S.getFullYear()-O.getFullYear()))===0&&(K=Y(S.getMonth()-O.getMonth()))===0&&(K=Y(S.getDate()-O.getDate())),K}function W(S){switch(S.getDay()){case 0:return new Date(S.getFullYear()-1,11,29);case 1:return S;case 2:return new Date(S.getFullYear(),0,3);case 3:return new Date(S.getFullYear(),0,2);case 4:return new Date(S.getFullYear(),0,1);case 5:return new Date(S.getFullYear()-1,11,31);case 6:return new Date(S.getFullYear()-1,11,30)}}function q(S){var O=Ga(new Date(S.tm_year+1900,0,1),S.tm_yday),Y=new Date(O.getFullYear(),0,4),K=new Date(O.getFullYear()+1,0,4),Be=W(Y),_t=W(K);return j(Be,O)<=0?j(_t,O)<=0?O.getFullYear()+1:O.getFullYear():O.getFullYear()-1}var x={"%a":S=>P[S.tm_wday].substring(0,3),"%A":S=>P[S.tm_wday],"%b":S=>M[S.tm_mon].substring(0,3),"%B":S=>M[S.tm_mon],"%C":S=>{var O=S.tm_year+1900;return B(O/100|0,2)},"%d":S=>B(S.tm_mday,2),"%e":S=>k(S.tm_mday,2," "),"%g":S=>q(S).toString().substring(2),"%G":S=>q(S),"%H":S=>B(S.tm_hour,2),"%I":S=>{var O=S.tm_hour;return O==0?O=12:O>12&&(O-=12),B(O,2)},"%j":S=>B(S.tm_mday+Ya(St(S.tm_year+1900)?qr:Yr,S.tm_mon-1),3),"%m":S=>B(S.tm_mon+1,2),"%M":S=>B(S.tm_min,2),"%n":()=>`
`,"%p":S=>S.tm_hour>=0&&S.tm_hour<12?"AM":"PM","%S":S=>B(S.tm_sec,2),"%t":()=>"	","%u":S=>S.tm_wday||7,"%U":S=>{var O=S.tm_yday+7-S.tm_wday;return B(Math.floor(O/7),2)},"%V":S=>{var O=Math.floor((S.tm_yday+7-(S.tm_wday+6)%7)/7);if((S.tm_wday+371-S.tm_yday-2)%7<=2&&O++,O){if(O==53){var Y=(S.tm_wday+371-S.tm_yday)%7;Y!=4&&(Y!=3||!St(S.tm_year))&&(O=1)}}else{O=52;var K=(S.tm_wday+7-S.tm_yday-1)%7;(K==4||K==5&&St(S.tm_year%400-1))&&O++}return B(O,2)},"%w":S=>S.tm_wday,"%W":S=>{var O=S.tm_yday+7-(S.tm_wday+6)%7;return B(Math.floor(O/7),2)},"%y":S=>(S.tm_year+1900).toString().substring(2),"%Y":S=>S.tm_year+1900,"%z":S=>{var O=S.tm_gmtoff,Y=O>=0;return O=Math.abs(O)/60,O=O/60*100+O%60,(Y?"+":"-")+("0000"+O).slice(-4)},"%Z":S=>S.tm_zone,"%%":()=>"%"};p=p.replace(/%%/g,"\0\0");for(var C in x)p.includes(C)&&(p=p.replace(new RegExp(C,"g"),x[C](g)));p=p.replace(/\0\0/g,"%");var Z=Ka(p);return Z.length>r?0:(Qa(Z,t),Z.length-1)},Za=(t,r,a,u,h)=>Xa(t,r,a,u);Ar=o.InternalError=class extends Error{constructor(t){super(t),this.name="InternalError"}},Po(),ke=o.BindingError=class extends Error{constructor(t){super(t),this.name="BindingError"}},jo(),Io(),zo(),Lr=o.UnboundTypeError=Go(Error,"UnboundTypeError"),ea(),ra();var ei={s:go,u:po,b:vo,g:yo,q:wo,J:bo,f:Co,V:To,d:mo,da:Eo,Q:So,_:$o,ca:Ko,ba:Xo,w:Zo,Y:na,x:aa,h:ia,L:ca,M:ua,t:da,o:fa,K:pa,C:Ta,A:Ea,ea:Sa,$:Pa,R:_a,ha:rr,fa:Ma,Z:ka,N:Ba,O:Na,aa:ja,B:La,X:Fa,W:Ha,T:za,U:Ja,E:mi,D:ai,F:pi,n:vi,a:ti,e:si,m:oi,k:ui,H:hi,v:di,G:gi,z:wi,P:Ci,l:ci,j:ii,c:ni,p:ri,I:fi,r:yi,i:li,y:bi,ga:qa,S:Za},G=ho(),we=o._free=t=>(we=o._free=G.ka)(t),cr=o._malloc=t=>(cr=o._malloc=G.la)(t),Gr=t=>(Gr=G.na)(t),H=(t,r)=>(H=G.oa)(t,r),et=t=>(et=G.pa)(t),z=()=>(z=G.qa)(),J=t=>(J=G.ra)(t),Kr=t=>(Kr=G.sa)(t),Qr=t=>(Qr=G.ta)(t),Xr=(t,r,a)=>(Xr=G.ua)(t,r,a),Zr=t=>(Zr=G.va)(t);o.dynCall_viijii=(t,r,a,u,h,g,p)=>(o.dynCall_viijii=G.wa)(t,r,a,u,h,g,p);var en=o.dynCall_jiiii=(t,r,a,u,h)=>(en=o.dynCall_jiiii=G.xa)(t,r,a,u,h);o.dynCall_iiiiij=(t,r,a,u,h,g,p)=>(o.dynCall_iiiiij=G.ya)(t,r,a,u,h,g,p),o.dynCall_iiiiijj=(t,r,a,u,h,g,p,y,C)=>(o.dynCall_iiiiijj=G.za)(t,r,a,u,h,g,p,y,C),o.dynCall_iiiiiijj=(t,r,a,u,h,g,p,y,C,P)=>(o.dynCall_iiiiiijj=G.Aa)(t,r,a,u,h,g,p,y,C,P);function ti(t,r){var a=z();try{return V(t)(r)}catch(u){if(J(a),u!==u+0)throw u;H(1,0)}}function ri(t,r,a,u){var h=z();try{V(t)(r,a,u)}catch(g){if(J(h),g!==g+0)throw g;H(1,0)}}function ni(t,r,a){var u=z();try{V(t)(r,a)}catch(h){if(J(u),h!==h+0)throw h;H(1,0)}}function oi(t,r,a,u){var h=z();try{return V(t)(r,a,u)}catch(g){if(J(h),g!==g+0)throw g;H(1,0)}}function ai(t,r,a,u,h){var g=z();try{return V(t)(r,a,u,h)}catch(p){if(J(g),p!==p+0)throw p;H(1,0)}}function ii(t,r){var a=z();try{V(t)(r)}catch(u){if(J(a),u!==u+0)throw u;H(1,0)}}function si(t,r,a){var u=z();try{return V(t)(r,a)}catch(h){if(J(u),h!==h+0)throw h;H(1,0)}}function ci(t){var r=z();try{V(t)()}catch(a){if(J(r),a!==a+0)throw a;H(1,0)}}function ui(t,r,a,u,h){var g=z();try{return V(t)(r,a,u,h)}catch(p){if(J(g),p!==p+0)throw p;H(1,0)}}function li(t,r,a,u,h,g,p,y,C,P,M){var k=z();try{V(t)(r,a,u,h,g,p,y,C,P,M)}catch(B){if(J(k),B!==B+0)throw B;H(1,0)}}function di(t,r,a,u,h,g,p){var y=z();try{return V(t)(r,a,u,h,g,p)}catch(C){if(J(y),C!==C+0)throw C;H(1,0)}}function fi(t,r,a,u,h){var g=z();try{V(t)(r,a,u,h)}catch(p){if(J(g),p!==p+0)throw p;H(1,0)}}function hi(t,r,a,u,h,g){var p=z();try{return V(t)(r,a,u,h,g)}catch(y){if(J(p),y!==y+0)throw y;H(1,0)}}function gi(t,r,a,u,h,g,p,y){var C=z();try{return V(t)(r,a,u,h,g,p,y)}catch(P){if(J(C),P!==P+0)throw P;H(1,0)}}function pi(t,r,a,u){var h=z();try{return V(t)(r,a,u)}catch(g){if(J(h),g!==g+0)throw g;H(1,0)}}function mi(t,r,a,u){var h=z();try{return V(t)(r,a,u)}catch(g){if(J(h),g!==g+0)throw g;H(1,0)}}function vi(t){var r=z();try{return V(t)()}catch(a){if(J(r),a!==a+0)throw a;H(1,0)}}function yi(t,r,a,u,h,g,p,y){var C=z();try{V(t)(r,a,u,h,g,p,y)}catch(P){if(J(C),P!==P+0)throw P;H(1,0)}}function wi(t,r,a,u,h,g,p,y,C,P,M,k){var B=z();try{return V(t)(r,a,u,h,g,p,y,C,P,M,k)}catch(j){if(J(B),j!==j+0)throw j;H(1,0)}}function bi(t,r,a,u,h,g,p,y,C,P,M,k,B,j,W,q){var x=z();try{V(t)(r,a,u,h,g,p,y,C,P,M,k,B,j,W,q)}catch(Z){if(J(x),Z!==Z+0)throw Z;H(1,0)}}function Ci(t,r,a,u,h){var g=z();try{return en(t,r,a,u,h)}catch(p){if(J(g),p!==p+0)throw p;H(1,0)}}var Pt;Ae=function t(){Pt||tn(),Pt||(Ae=t)};function tn(){if(de>0||(be(),de>0))return;function t(){Pt||(Pt=!0,o.calledRun=!0,!D&&(ae(),i(o),o.onRuntimeInitialized&&o.onRuntimeInitialized(),Ft()))}o.setStatus?(o.setStatus("Running..."),setTimeout(function(){setTimeout(function(){o.setStatus("")},1),t()},1)):t()}if(o.preInit)for(typeof o.preInit=="function"&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return tn(),n.ready}})();function Us(e){return _r($r,e)}async function xs(e,n){return Ls($r,e,n)}async function Hs(e,n){return Fs($r,e,n)}var it;class mr extends EventTarget{constructor(n={}){var o;super(),gs(this,it,void 0);try{const i=(o=n==null?void 0:n.formats)==null?void 0:o.filter(s=>s!=="unknown");if((i==null?void 0:i.length)===0)throw new TypeError("Hint option provided, but is empty.");i==null||i.forEach(s=>{if(!Rt.has(s))throw new TypeError(`Failed to read the 'formats' property from 'BarcodeDetectorOptions': The provided value '${s}' is not a valid enum value of type BarcodeFormat.`)}),ps(this,it,i??[]),Us().then(s=>{this.dispatchEvent(new CustomEvent("load",{detail:s}))}).catch(s=>{this.dispatchEvent(new CustomEvent("error",{detail:s}))})}catch(i){throw un(i,"Failed to construct 'BarcodeDetector'")}}static async getSupportedFormats(){return ms.filter(n=>n!=="unknown")}async detect(n){try{const o=await Es(n);if(o===null)return[];let i;try{Jn(o)?i=await xs(o,{tryHarder:!0,formats:cn(this,it).map(s=>Rt.get(s))}):i=await Hs(o,{tryHarder:!0,formats:cn(this,it).map(s=>Rt.get(s))})}catch(s){throw console.error(s),new DOMException("Barcode detection service unavailable.","NotSupportedError")}return i.map(s=>{const{topLeft:{x:c,y:d},topRight:{x:f,y:l},bottomLeft:{x:m,y:w},bottomRight:{x:T,y:$}}=s.position,_=Math.min(c,f,m,T),A=Math.min(d,l,w,$),D=Math.max(c,f,m,T),N=Math.max(d,l,w,$);return{boundingBox:new DOMRectReadOnly(_,A,D-_,N-A),rawValue:s.text,format:vs(s.format),cornerPoints:[{x:c,y:d},{x:f,y:l},{x:T,y:$},{x:m,y:w}]}})}catch(o){throw un(o,"Failed to execute 'detect' on 'BarcodeDetector'")}}}it=new WeakMap;const Kn=(e,n,o="error")=>{let i,s;const c=new Promise((d,f)=>{i=d,s=f,e.addEventListener(n,i),e.addEventListener(o,s)});return c.finally(()=>{e.removeEventListener(n,i),e.removeEventListener(o,s)}),c},hn=e=>new Promise(n=>setTimeout(n,e));class Qn extends Error{constructor(){super("this browser has no Stream API support"),this.name="StreamApiNotSupportedError"}}class Ws extends Error{constructor(){super("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP."),this.name="InsecureContextError"}}class Vs extends Error{constructor(){super("Loading camera stream timed out after 6 seconds. If you are on iOS in PWA mode, this is a known issue (see https://github.com/gruhn/vue-qrcode-reader/issues/298)"),this.name="StreamLoadTimeoutError"}}const zs=e=>{let n=!1,o;return(...i)=>(n||(o=e(i),n=!0),o)};function ge(e,n){if(e===!1)throw new Error(n??"assertion failure")}function gn(e){throw new Error("this code should be unreachable")}function Js(){return navigator.platform.toUpperCase().includes("MAC")}let Xn;async function qs(e){if(window.BarcodeDetector===void 0)return console.debug("[vue-qrcode-reader] Native BarcodeDetector not supported. Will use polyfill."),new mr({formats:e});const n=await window.BarcodeDetector.getSupportedFormats(),o=e.filter(i=>!n.includes(i));return o.length>0?(console.debug(`[vue-qrcode-reader] Native BarcodeDetector does not support formats ${JSON.stringify(o)}. Will use polyfill.`),new mr({formats:e})):Js()&&e.includes("pdf417")?(console.debug("[vue-qrcode-reader] Native BarcodeDetector is buggy for PDF417 codes on MacOS. Will use polyfill."),new mr({formats:e})):(console.debug("[vue-qrcode-reader] Will use native BarcodeDetector."),new window.BarcodeDetector({formats:e}))}async function Zn(e){Xn=await qs(e)}const Ys=async(e,{detectHandler:n,locateHandler:o,minDelay:i,formats:s})=>{console.debug("[vue-qrcode-reader] start scanning"),await Zn(s);const c=d=>async f=>{if(e.readyState===0)console.debug("[vue-qrcode-reader] stop scanning: video element readyState is 0");else{const{lastScanned:l,contentBefore:m,lastScanHadContent:w}=d;if(f-l<i)window.requestAnimationFrame(c(d));else{const T=await Xn.detect(e),$=T.some(D=>!m.includes(D.rawValue));$&&n(T);const _=T.length>0;_&&o(T),!_&&w&&o(T);const A={lastScanned:f,lastScanHadContent:_,contentBefore:$?T.map(D=>D.rawValue):m};window.requestAnimationFrame(c(A))}}};c({lastScanned:performance.now(),contentBefore:[],lastScanHadContent:!1})(performance.now())};var eo={},oe={};Object.defineProperty(oe,"__esModule",{value:!0});oe.compactObject=no;oe.deprecated=nc;var Gs=oe.detectBrowser=oc;oe.disableLog=ec;oe.disableWarnings=tc;oe.extractVersion=Dt;oe.filterStats=ac;oe.log=rc;oe.walkStats=kt;oe.wrapPeerConnectionEvent=Zs;function Ks(e,n,o){return n=Qs(n),n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Qs(e){var n=Xs(e,"string");return Pe(n)==="symbol"?n:String(n)}function Xs(e,n){if(Pe(e)!=="object"||e===null)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var i=o.call(e,n);if(Pe(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Pe(e){"@babel/helpers - typeof";return Pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Pe(e)}var to=!0,ro=!0;function Dt(e,n,o){var i=e.match(n);return i&&i.length>=o&&parseInt(i[o],10)}function Zs(e,n,o){if(e.RTCPeerConnection){var i=e.RTCPeerConnection.prototype,s=i.addEventListener;i.addEventListener=function(d,f){if(d!==n)return s.apply(this,arguments);var l=function(m){var w=o(m);w&&(f.handleEvent?f.handleEvent(w):f(w))};return this._eventMap=this._eventMap||{},this._eventMap[n]||(this._eventMap[n]=new Map),this._eventMap[n].set(f,l),s.apply(this,[d,l])};var c=i.removeEventListener;i.removeEventListener=function(d,f){if(d!==n||!this._eventMap||!this._eventMap[n])return c.apply(this,arguments);if(!this._eventMap[n].has(f))return c.apply(this,arguments);var l=this._eventMap[n].get(f);return this._eventMap[n].delete(f),this._eventMap[n].size===0&&delete this._eventMap[n],Object.keys(this._eventMap).length===0&&delete this._eventMap,c.apply(this,[d,l])},Object.defineProperty(i,"on"+n,{get:function(){return this["_on"+n]},set:function(d){this["_on"+n]&&(this.removeEventListener(n,this["_on"+n]),delete this["_on"+n]),d&&this.addEventListener(n,this["_on"+n]=d)},enumerable:!0,configurable:!0})}}function ec(e){return typeof e!="boolean"?new Error("Argument type: "+Pe(e)+". Please use a boolean."):(to=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function tc(e){return typeof e!="boolean"?new Error("Argument type: "+Pe(e)+". Please use a boolean."):(ro=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function rc(){if((typeof window>"u"?"undefined":Pe(window))==="object"){if(to)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function nc(e,n){ro&&console.warn(e+" is deprecated, please use "+n+" instead.")}function oc(e){var n={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return n.browser="Not a browser.",n;var o=e.navigator;if(o.mozGetUserMedia)n.browser="firefox",n.version=Dt(o.userAgent,/Firefox\/(\d+)\./,1);else if(o.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)n.browser="chrome",n.version=Dt(o.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(e.RTCPeerConnection&&o.userAgent.match(/AppleWebKit\/(\d+)\./))n.browser="safari",n.version=Dt(o.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype;else return n.browser="Not a supported browser.",n;return n}function pn(e){return Object.prototype.toString.call(e)==="[object Object]"}function no(e){return pn(e)?Object.keys(e).reduce(function(n,o){var i=pn(e[o]),s=i?no(e[o]):e[o],c=i&&!Object.keys(s).length;return s===void 0||c?n:Object.assign(n,Ks({},o,s))},{}):e}function kt(e,n,o){!n||o.has(n.id)||(o.set(n.id,n),Object.keys(n).forEach(function(i){i.endsWith("Id")?kt(e,e.get(n[i]),o):i.endsWith("Ids")&&n[i].forEach(function(s){kt(e,e.get(s),o)})}))}function ac(e,n,o){var i=o?"outbound-rtp":"inbound-rtp",s=new Map;if(n===null)return s;var c=[];return e.forEach(function(d){d.type==="track"&&d.trackIdentifier===n.id&&c.push(d)}),c.forEach(function(d){e.forEach(function(f){f.type===i&&f.trackId===d.id&&kt(e,f,s)})}),s}Object.defineProperty(eo,"__esModule",{value:!0});var ic=eo.shimGetUserMedia=uc,sc=cc(oe);function oo(e){if(typeof WeakMap!="function")return null;var n=new WeakMap,o=new WeakMap;return(oo=function(i){return i?o:n})(e)}function cc(e,n){if(e&&e.__esModule)return e;if(e===null||Ee(e)!=="object"&&typeof e!="function")return{default:e};var o=oo(n);if(o&&o.has(e))return o.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if(c!=="default"&&Object.prototype.hasOwnProperty.call(e,c)){var d=s?Object.getOwnPropertyDescriptor(e,c):null;d&&(d.get||d.set)?Object.defineProperty(i,c,d):i[c]=e[c]}return i.default=e,o&&o.set(e,i),i}function Ee(e){"@babel/helpers - typeof";return Ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ee(e)}var mn=sc.log;function uc(e,n){var o=e&&e.navigator;if(o.mediaDevices){var i=function(l){if(Ee(l)!=="object"||l.mandatory||l.optional)return l;var m={};return Object.keys(l).forEach(function(w){if(!(w==="require"||w==="advanced"||w==="mediaSource")){var T=Ee(l[w])==="object"?l[w]:{ideal:l[w]};T.exact!==void 0&&typeof T.exact=="number"&&(T.min=T.max=T.exact);var $=function(A,D){return A?A+D.charAt(0).toUpperCase()+D.slice(1):D==="deviceId"?"sourceId":D};if(T.ideal!==void 0){m.optional=m.optional||[];var _={};typeof T.ideal=="number"?(_[$("min",w)]=T.ideal,m.optional.push(_),_={},_[$("max",w)]=T.ideal,m.optional.push(_)):(_[$("",w)]=T.ideal,m.optional.push(_))}T.exact!==void 0&&typeof T.exact!="number"?(m.mandatory=m.mandatory||{},m.mandatory[$("",w)]=T.exact):["min","max"].forEach(function(A){T[A]!==void 0&&(m.mandatory=m.mandatory||{},m.mandatory[$(A,w)]=T[A])})}}),l.advanced&&(m.optional=(m.optional||[]).concat(l.advanced)),m},s=function(l,m){if(n.version>=61)return m(l);if(l=JSON.parse(JSON.stringify(l)),l&&Ee(l.audio)==="object"){var w=function(A,D,N){D in A&&!(N in A)&&(A[N]=A[D],delete A[D])};l=JSON.parse(JSON.stringify(l)),w(l.audio,"autoGainControl","googAutoGainControl"),w(l.audio,"noiseSuppression","googNoiseSuppression"),l.audio=i(l.audio)}if(l&&Ee(l.video)==="object"){var T=l.video.facingMode;T=T&&(Ee(T)==="object"?T:{ideal:T});var $=n.version<66;if(T&&(T.exact==="user"||T.exact==="environment"||T.ideal==="user"||T.ideal==="environment")&&!(o.mediaDevices.getSupportedConstraints&&o.mediaDevices.getSupportedConstraints().facingMode&&!$)){delete l.video.facingMode;var _;if(T.exact==="environment"||T.ideal==="environment"?_=["back","rear"]:(T.exact==="user"||T.ideal==="user")&&(_=["front"]),_)return o.mediaDevices.enumerateDevices().then(function(A){A=A.filter(function(N){return N.kind==="videoinput"});var D=A.find(function(N){return _.some(function(R){return N.label.toLowerCase().includes(R)})});return!D&&A.length&&_.includes("back")&&(D=A[A.length-1]),D&&(l.video.deviceId=T.exact?{exact:D.deviceId}:{ideal:D.deviceId}),l.video=i(l.video),mn("chrome: "+JSON.stringify(l)),m(l)})}l.video=i(l.video)}return mn("chrome: "+JSON.stringify(l)),m(l)},c=function(l){return n.version>=64?l:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[l.name]||l.name,message:l.message,constraint:l.constraint||l.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},d=function(l,m,w){s(l,function(T){o.webkitGetUserMedia(T,m,function($){w&&w(c($))})})};if(o.getUserMedia=d.bind(o),o.mediaDevices.getUserMedia){var f=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(l){return s(l,function(m){return f(m).then(function(w){if(m.audio&&!w.getAudioTracks().length||m.video&&!w.getVideoTracks().length)throw w.getTracks().forEach(function(T){T.stop()}),new DOMException("","NotFoundError");return w},function(w){return Promise.reject(c(w))})})}}}}var ao={};Object.defineProperty(ao,"__esModule",{value:!0});var lc=ao.shimGetUserMedia=hc,dc=fc(oe);function io(e){if(typeof WeakMap!="function")return null;var n=new WeakMap,o=new WeakMap;return(io=function(i){return i?o:n})(e)}function fc(e,n){if(e&&e.__esModule)return e;if(e===null||Fe(e)!=="object"&&typeof e!="function")return{default:e};var o=io(n);if(o&&o.has(e))return o.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if(c!=="default"&&Object.prototype.hasOwnProperty.call(e,c)){var d=s?Object.getOwnPropertyDescriptor(e,c):null;d&&(d.get||d.set)?Object.defineProperty(i,c,d):i[c]=e[c]}return i.default=e,o&&o.set(e,i),i}function Fe(e){"@babel/helpers - typeof";return Fe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Fe(e)}function hc(e,n){var o=e&&e.navigator,i=e&&e.MediaStreamTrack;if(o.getUserMedia=function(l,m,w){dc.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),o.mediaDevices.getUserMedia(l).then(m,w)},!(n.version>55&&"autoGainControl"in o.mediaDevices.getSupportedConstraints())){var s=function(l,m,w){m in l&&!(w in l)&&(l[w]=l[m],delete l[m])},c=o.mediaDevices.getUserMedia.bind(o.mediaDevices);if(o.mediaDevices.getUserMedia=function(l){return Fe(l)==="object"&&Fe(l.audio)==="object"&&(l=JSON.parse(JSON.stringify(l)),s(l.audio,"autoGainControl","mozAutoGainControl"),s(l.audio,"noiseSuppression","mozNoiseSuppression")),c(l)},i&&i.prototype.getSettings){var d=i.prototype.getSettings;i.prototype.getSettings=function(){var l=d.apply(this,arguments);return s(l,"mozAutoGainControl","autoGainControl"),s(l,"mozNoiseSuppression","noiseSuppression"),l}}if(i&&i.prototype.applyConstraints){var f=i.prototype.applyConstraints;i.prototype.applyConstraints=function(l){return this.kind==="audio"&&Fe(l)==="object"&&(l=JSON.parse(JSON.stringify(l)),s(l,"autoGainControl","mozAutoGainControl"),s(l,"noiseSuppression","mozNoiseSuppression")),f.apply(this,[l])}}}}var me={};Object.defineProperty(me,"__esModule",{value:!0});me.shimAudioContext=Ec;me.shimCallbacksAPI=yc;me.shimConstraints=uo;me.shimCreateOfferLegacy=Tc;var gc=me.shimGetUserMedia=wc;me.shimLocalStreamsAPI=mc;me.shimRTCIceServerUrls=bc;me.shimRemoteStreamsAPI=vc;me.shimTrackEventTransceiver=Cc;var so=pc(oe);function co(e){if(typeof WeakMap!="function")return null;var n=new WeakMap,o=new WeakMap;return(co=function(i){return i?o:n})(e)}function pc(e,n){if(e&&e.__esModule)return e;if(e===null||_e(e)!=="object"&&typeof e!="function")return{default:e};var o=co(n);if(o&&o.has(e))return o.get(e);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if(c!=="default"&&Object.prototype.hasOwnProperty.call(e,c)){var d=s?Object.getOwnPropertyDescriptor(e,c):null;d&&(d.get||d.set)?Object.defineProperty(i,c,d):i[c]=e[c]}return i.default=e,o&&o.set(e,i),i}function _e(e){"@babel/helpers - typeof";return _e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_e(e)}function mc(e){if(!(_e(e)!=="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(o){var i=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(o)||this._localStreams.push(o),o.getAudioTracks().forEach(function(s){return n.call(i,s,o)}),o.getVideoTracks().forEach(function(s){return n.call(i,s,o)})},e.RTCPeerConnection.prototype.addTrack=function(o){for(var i=this,s=arguments.length,c=new Array(s>1?s-1:0),d=1;d<s;d++)c[d-1]=arguments[d];return c&&c.forEach(function(f){i._localStreams?i._localStreams.includes(f)||i._localStreams.push(f):i._localStreams=[f]}),n.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(o){var i=this;this._localStreams||(this._localStreams=[]);var s=this._localStreams.indexOf(o);if(s!==-1){this._localStreams.splice(s,1);var c=o.getTracks();this.getSenders().forEach(function(d){c.includes(d.track)&&i.removeTrack(d)})}})}}function vc(e){if(!(_e(e)!=="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(o){var i=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=o),this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(function(c){if(i._remoteStreams||(i._remoteStreams=[]),!i._remoteStreams.includes(c)){i._remoteStreams.push(c);var d=new Event("addstream");d.stream=c,i.dispatchEvent(d)}})})}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var o=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(function(s){if(o._remoteStreams||(o._remoteStreams=[]),!(o._remoteStreams.indexOf(s)>=0)){o._remoteStreams.push(s);var c=new Event("addstream");c.stream=s,o.dispatchEvent(c)}})}),n.apply(o,arguments)}}}function yc(e){if(!(_e(e)!=="object"||!e.RTCPeerConnection)){var n=e.RTCPeerConnection.prototype,o=n.createOffer,i=n.createAnswer,s=n.setLocalDescription,c=n.setRemoteDescription,d=n.addIceCandidate;n.createOffer=function(l,m){var w=arguments.length>=2?arguments[2]:arguments[0],T=o.apply(this,[w]);return m?(T.then(l,m),Promise.resolve()):T},n.createAnswer=function(l,m){var w=arguments.length>=2?arguments[2]:arguments[0],T=i.apply(this,[w]);return m?(T.then(l,m),Promise.resolve()):T};var f=function(l,m,w){var T=s.apply(this,[l]);return w?(T.then(m,w),Promise.resolve()):T};n.setLocalDescription=f,f=function(l,m,w){var T=c.apply(this,[l]);return w?(T.then(m,w),Promise.resolve()):T},n.setRemoteDescription=f,f=function(l,m,w){var T=d.apply(this,[l]);return w?(T.then(m,w),Promise.resolve()):T},n.addIceCandidate=f}}function wc(e){var n=e&&e.navigator;if(n.mediaDevices&&n.mediaDevices.getUserMedia){var o=n.mediaDevices,i=o.getUserMedia.bind(o);n.mediaDevices.getUserMedia=function(s){return i(uo(s))}}!n.getUserMedia&&n.mediaDevices&&n.mediaDevices.getUserMedia&&(n.getUserMedia=(function(s,c,d){n.mediaDevices.getUserMedia(s).then(c,d)}).bind(n))}function uo(e){return e&&e.video!==void 0?Object.assign({},e,{video:so.compactObject(e.video)}):e}function bc(e){if(e.RTCPeerConnection){var n=e.RTCPeerConnection;e.RTCPeerConnection=function(o,i){if(o&&o.iceServers){for(var s=[],c=0;c<o.iceServers.length;c++){var d=o.iceServers[c];d.urls===void 0&&d.url?(so.deprecated("RTCIceServer.url","RTCIceServer.urls"),d=JSON.parse(JSON.stringify(d)),d.urls=d.url,delete d.url,s.push(d)):s.push(o.iceServers[c])}o.iceServers=s}return new n(o,i)},e.RTCPeerConnection.prototype=n.prototype,"generateCertificate"in n&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return n.generateCertificate}})}}function Cc(e){_e(e)==="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Tc(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(o){if(o){typeof o.offerToReceiveAudio<"u"&&(o.offerToReceiveAudio=!!o.offerToReceiveAudio);var i=this.getTransceivers().find(function(c){return c.receiver.track.kind==="audio"});o.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):o.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof o.offerToReceiveVideo<"u"&&(o.offerToReceiveVideo=!!o.offerToReceiveVideo);var s=this.getTransceivers().find(function(c){return c.receiver.track.kind==="video"});o.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):o.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return n.apply(this,arguments)}}function Ec(e){_e(e)!=="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}const Sc=zs(()=>{const e=Gs(window);switch(e.browser){case"chrome":ic(window,e);break;case"firefox":lc(window,e);break;case"safari":gc(window,e);break;default:throw new Qn}});let Ue=Promise.resolve({type:"stop",data:{}});async function vn(e,n,o){var i,s,c;if(console.debug("[vue-qrcode-reader] starting camera with constraints: ",JSON.stringify(n)),window.isSecureContext!==!0)throw new Ws;if(((i=navigator==null?void 0:navigator.mediaDevices)==null?void 0:i.getUserMedia)===void 0)throw new Qn;Sc(),console.debug("[vue-qrcode-reader] calling getUserMedia");const d=await navigator.mediaDevices.getUserMedia({audio:!1,video:n});e.srcObject!==void 0?e.srcObject=d:e.mozSrcObject!==void 0?e.mozSrcObject=d:window.URL.createObjectURL?e.src=window.URL.createObjectURL(d):window.webkitURL?e.src=window.webkitURL.createObjectURL(d):e.src=d.id,e.play(),console.debug("[vue-qrcode-reader] waiting for video element to load"),await Promise.race([Kn(e,"loadeddata"),hn(6e3).then(()=>{throw new Vs})]),console.debug("[vue-qrcode-reader] video element loaded"),await hn(500);const[f]=d.getVideoTracks(),l=(c=(s=f==null?void 0:f.getCapabilities)==null?void 0:s.call(f))!=null?c:{};let m=!1;return o&&l.torch&&(await f.applyConstraints({advanced:[{torch:!0}]}),m=!0),console.debug("[vue-qrcode-reader] camera ready"),{type:"start",data:{videoEl:e,stream:d,capabilities:l,constraints:n,isTorchOn:m}}}async function Pc(e,{constraints:n,torch:o,restart:i=!1}){Ue=Ue.then(c=>{if(c.type==="start"){const{data:{videoEl:d,stream:f,constraints:l,isTorchOn:m}}=c;return!i&&e===d&&n===l&&o===m?c:lo(d,f,m).then(()=>vn(e,n,o))}else if(c.type==="stop"||c.type==="failed")return vn(e,n,o);gn()}).catch(c=>(console.debug(`[vue-qrcode-reader] starting camera failed with "${c}"`),{type:"failed",error:c}));const s=await Ue;if(s.type==="stop")throw new Error("Something went wrong with the camera task queue (start task).");if(s.type==="failed")throw s.error;if(s.type==="start")return s.data.capabilities;gn()}async function lo(e,n,o){console.debug("[vue-qrcode-reader] stopping camera"),e.src="",e.srcObject=null,e.load(),await Kn(e,"error");for(const i of n.getTracks())o!=null||await i.applyConstraints({advanced:[{torch:!1}]}),n.removeTrack(i),i.stop();return{type:"stop",data:{}}}async function Mt(){if(Ue=Ue.then(e=>{if(e.type==="stop"||e.type==="failed")return e;const{data:{videoEl:n,stream:o,isTorchOn:i}}=e;return lo(n,o,i)}),(await Ue).type==="start")throw new Error("Something went wrong with the camera task queue (stop task).")}const _c=yn({__name:"QrcodeStream",props:{constraints:{default:()=>({facingMode:"environment"})},formats:{default:()=>["qr_code"]},paused:{type:Boolean,default:!1},torch:{type:Boolean,default:!1},track:{type:Function,default:void 0}},emits:["detect","camera-on","camera-off","error"],setup(e,{emit:n}){const o=e,i=n,s=ne(o.constraints),c=ne(o.formats);rt(()=>o.constraints,(b,v)=>{JSON.stringify(b)!==JSON.stringify(v)&&(s.value=b)},{deep:!0}),rt(()=>o.formats,(b,v)=>{JSON.stringify(b)!==JSON.stringify(v)&&(c.value=b)},{deep:!0});const d=ne(),f=ne(),l=ne(),m=ne(!1),w=ne(!1);wn(()=>{w.value=!0}),bn(()=>{Mt()});const T=ur(()=>({torch:o.torch,constraints:s.value,shouldStream:w.value&&!o.paused}));rt(T,async b=>{const v=l.value;ge(v!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus video element should always be defined.");const E=d.value;ge(E!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus canvas should always be defined.");const L=E.getContext("2d");if(ge(L!==null,"if cavnas is defined, canvas 2d context should also be non-null"),b.shouldStream){Mt(),m.value=!1;try{const F=await Pc(v,b);w.value?(m.value=!0,i("camera-on",F)):await Mt()}catch(F){i("error",F)}}else E.width=v.videoWidth,E.height=v.videoHeight,L.drawImage(v,0,0,v.videoWidth,v.videoHeight),Mt(),m.value=!1,i("camera-off")},{deep:!0}),rt(c,async b=>{w.value&&await Zn(b)});const $=ur(()=>T.value.shouldStream&&m.value);rt($,b=>{if(b){ge(d.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus pause frame canvas is defined"),_(d.value),ge(f.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus tracking canvas is defined"),_(f.value);const v=()=>o.track===void 0?500:40;ge(l.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus video element is defined"),Ys(l.value,{detectHandler:E=>i("detect",E),formats:c.value,locateHandler:A,minDelay:v()})}});const _=b=>{const v=b.getContext("2d");ge(v!==null,"canvas 2d context should always be non-null"),v.clearRect(0,0,b.width,b.height)},A=b=>{const v=f.value;ge(v!==void 0,"onLocate handler should only be called when component is mounted. Thus tracking canvas is always defined.");const E=l.value;if(ge(E!==void 0,"onLocate handler should only be called when component is mounted. Thus video element is always defined."),b.length===0||o.track===void 0)_(v);else{const L=E.offsetWidth,F=E.offsetHeight,Q=E.videoWidth,re=E.videoHeight,ee=Math.max(L/Q,F/re),ue=Q*ee,be=re*ee,ae=ue/Q,Ft=be/re,Ut=(L-ue)/2,xt=(F-be)/2,qe=({x:Ce,y:ie})=>({x:Math.floor(Ce*ae),y:Math.floor(ie*Ft)}),de=({x:Ce,y:ie})=>({x:Math.floor(Ce+Ut),y:Math.floor(ie+xt)}),Ae=b.map(Ce=>{const{boundingBox:ie,cornerPoints:Ht}=Ce,{x:dt,y:Te}=de(qe({x:ie.x,y:ie.y})),{x:ft,y:Wt}=qe({x:ie.width,y:ie.height});return{...Ce,cornerPoints:Ht.map(ht=>de(qe(ht))),boundingBox:DOMRectReadOnly.fromRect({x:dt,y:Te,width:ft,height:Wt})}});v.width=E.offsetWidth,v.height=E.offsetHeight;const lt=v.getContext("2d");ge(lt!==null,"canvas 2d context should always be non-null"),o.track(Ae,lt)}},D={width:"100%",height:"100%",position:"relative","z-index":"0"},N={width:"100%",height:"100%",position:"absolute",top:"0",left:"0"},R={width:"100%",height:"100%","object-fit":"cover"},I=ur(()=>$.value?R:{...R,visibility:"hidden",position:"absolute"});return(b,v)=>(De(),Oe("div",{style:D},[te("video",{ref_key:"videoRef",ref:l,style:Ti(I.value),autoplay:"",muted:"",playsinline:""},null,4),Ei(te("canvas",{id:"qrcode-stream-pause-frame",ref_key:"pauseFrameRef",ref:d,style:R},null,512),[[Si,!$.value]]),te("canvas",{id:"qrcode-stream-tracking-layer",ref_key:"trackingLayerRef",ref:f,style:N},null,512),te("div",{style:N},[Pi(b.$slots,"default")])]))}}),$c={class:"container"},Ac={key:0,class:"scanner-overlay"},Mc={class:"controls"},Rc={class:"status"},Dc={key:0},Oc={vきてきたif:"status === 'ready'"},Ic={key:1},kc=["src"],Bc=["href"],Nc={key:2},jc=["src"],Lc=["href"],Fc={key:3},Uc=yn({__name:"RTCConnector",setup(e){const n=ne(null),o=ne(null),i=ne(""),s=ne("init"),c=ne(!1),d=ne(""),f=ne(""),l=ne([]);async function m(){try{const b=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});n.value&&(n.value.srcObject=b,console.log("Камера инициализирована")),s.value="ready",w()}catch(b){console.error("Ошибка инициализации камеры:",b),alert("Не удалось получить доступ к камере")}}function w(){var b;if(o.value=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),o.value.onicecandidate=v=>{v.candidate&&(l.value.push(v.candidate.toJSON()),console.log("Добавлен ICE-кандидат:",v.candidate))},o.value.ontrack=v=>{n.value&&!n.value.srcObject&&(n.value.srcObject=v.streams[0],console.log("Получен удаленный поток"))},o.value.onconnectionstatechange=()=>{var v,E,L,F;console.log("Состояние соединения:",(v=o.value)==null?void 0:v.connectionState),((E=o.value)==null?void 0:E.connectionState)==="connected"?s.value="connected":(((L=o.value)==null?void 0:L.connectionState)==="disconnected"||((F=o.value)==null?void 0:F.connectionState)==="failed")&&(s.value="init",alert("Соединение разорвано"),I())},(b=n.value)!=null&&b.srcObject){const v=n.value.srcObject;v.getTracks().forEach(E=>{var L;(L=o.value)==null||L.addTrack(E,v),console.log("Добавлен трек:",E.kind)})}}function T(b){const v={sdp:b,iceCandidates:l.value},E=btoa(JSON.stringify(v));return`${window.location.origin}${window.location.pathname}?data=${E}`}async function $(){if(!o.value){console.error("peerConnection не инициализирован"),alert("Ошибка: соединение не инициализировано");return}try{const b=await o.value.createOffer();await o.value.setLocalDescription(b),console.log("Offer создан:",b),f.value=T(b),i.value=await xe.toDataURL(f.value,{width:300,errorCorrectionLevel:"H"}),console.log("QR-код сгенерирован:",f.value),s.value="offer"}catch(b){console.error("Ошибка создания Offer:",b),alert(`Ошибка создания Offer: ${Le(b)}`)}}async function _(){if(!o.value||!d.value){console.error("peerConnection или sdpData отсутствуют"),alert("Ошибка: данные для ответа отсутствуют");return}try{const b=JSON.parse(d.value);if(await o.value.setRemoteDescription(b.sdp),b.iceCandidates)for(const E of b.iceCandidates)await o.value.addIceCandidate(new RTCIceCandidate(E)),console.log("Добавлен удаленный ICE-кандидат:",E);const v=await o.value.createAnswer();await o.value.setLocalDescription(v),f.value=T(v),i.value=await xe.toDataURL(f.value,{width:300,errorCorrectionLevel:"H"}),console.log("QR-код для ответа сгенерирован:",f.value),s.value="answer"}catch(b){alert(`Ошибка создания Answer: ${Le(b)}`)}}async function A(){if(!o.value||!d.value){console.error("peerConnection или sdpData отсутствуют"),alert("Ошибка: данные для подключения отсутствуют");return}try{const b=JSON.parse(d.value);if(await o.value.setRemoteDescription(b.sdp),b.iceCandidates)for(const v of b.iceCandidates)await o.value.addIceCandidate(new RTCIceCandidate(v)),console.log("Добавлен удаленный ICE-кандидат:",v);s.value="connected"}catch(b){alert(`Ошибка подключения: ${Le(b)}`)}}function D(b){var v;console.log("Сканирован QR-код:",b);try{let E;if(b.startsWith("http")){const F=new URL(b).searchParams.get("data");if(F)E=JSON.parse(decodeURIComponent(atob(F)));else throw new Error("Нет данных в URL")}else E=JSON.parse(b);d.value=JSON.stringify(E),c.value=!1,(v=navigator.vibrate)==null||v.call(navigator,100),console.log("Данные SDP и ICE-кандидаты сохранены:",E),s.value==="ready"?_():s.value==="offer"&&A()}catch(E){console.error("Ошибка обработки QR-кода:",E),alert(`Ошибка обработки QR-кода: ${Le(E)}`)}}function N(b){console.error("Ошибка сканера QR-кода:",b),alert(`Ошибка сканера: ${Le(b)}`),c.value=!1}function R(){const v=new URLSearchParams(window.location.search).get("data");if(v)try{d.value=decodeURIComponent(atob(v)),console.log("URL распарсен:",d.value),s.value==="ready"?_():s.value==="offer"&&A()}catch(E){console.error("Ошибка парсинга URL:",E),alert(`Ошибка парсинга URL: ${Le(E)}`)}}function I(){var b;o.value&&(o.value.close(),o.value=null,console.log("Соединение закрыто")),(b=n.value)!=null&&b.srcObject&&(n.value.srcObject.getTracks().forEach(E=>E.stop()),n.value.srcObject=null,console.log("Медиапоток остановлен")),l.value=[],i.value="",f.value="",s.value="init"}return wn(()=>{m(),R()}),bn(()=>{I()}),(b,v)=>(De(),Oe("div",$c,[te("video",{ref_key:"video",ref:n,autoplay:"",playsinline:""},null,512),c.value?(De(),Oe("div",Ac,[Ne(je(_c),{onDecode:D,onError:N,camera:{facingMode:"environment"}}),te("button",{onClick:v[0]||(v[0]=E=>c.value=!1)},"Закрыть сканер")])):nt("",!0),te("div",Mc,[te("div",Rc," Статус: "+lr(s.value==="init"?"Инициализация":s.value==="ready"?"Готов к подключению":s.value==="offer"?"Ожидаем ответа":s.value==="answer"?"Ответ сгенерирован":"Соединение установлено"),1),s.value==="init"?(De(),Oe("div",Dc,[Ne(je(tt),{onClick:m},{default:ot(()=>v[3]||(v[3]=[at("Включить камеру")])),_:1})])):nt("",!0),te("div",Oc,[Ne(je(tt),{onClick:$},{default:ot(()=>v[4]||(v[4]=[at("Создать предложение (Offer)")])),_:1}),Ne(je(tt),{onClick:v[1]||(v[1]=E=>c.value=!0)},{default:ot(()=>v[5]||(v[5]=[at("Сканировать предложение")])),_:1})]),i.value&&s.value==="offer"?(De(),Oe("div",Ic,[v[7]||(v[7]=te("h3",null,"Отсканируйте этот код на другом устройстве:",-1)),te("img",{src:i.value,alt:"QR-код"},null,8,kc),v[8]||(v[8]=te("p",null,"Или отправьте ссылку:",-1)),te("a",{href:f.value,target:"_blank"},lr(f.value),9,Bc),Ne(je(tt),{onClick:v[2]||(v[2]=E=>c.value=!0)},{default:ot(()=>v[6]||(v[6]=[at("Сканировать ответ")])),_:1})])):nt("",!0),i.value&&s.value==="answer"?(De(),Oe("div",Nc,[v[9]||(v[9]=te("h3",null,"Отправьте этот ответ:",-1)),te("img",{src:i.value,alt:"QR-код"},null,8,jc),te("a",{href:f.value,target:"_blank"},lr(f.value),9,Lc)])):nt("",!0),s.value==="connected"?(De(),Oe("div",Fc,[Ne(je(tt),{onClick:I},{default:ot(()=>v[10]||(v[10]=[at("Отключить")])),_:1})])):nt("",!0)])]))}}),Vc=_i(Uc,[["__scopeId","data-v-a2b7896a"]]);export{Vc as default};
